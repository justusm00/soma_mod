<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: mc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0fb97dd43959fc0896d7b78e5ef47194.html">c_src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mc.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions required for any Monte-Carlo move of the system.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;<a class="el" href="soma__config_8h_source.html">soma_config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rng_8h_source.html">rng.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="monomer_8h_source.html">monomer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="polymer_8h_source.html">polymer.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for mc.h:</div>
<div class="dyncontent">
<div class="center"><img src="mc_8h__incl.png" border="0" usemap="#amc_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="mc_8h__dep__incl.png" border="0" usemap="#amc_8hdep" alt=""/></div>
</div>
</div>
<p><a href="mc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a945f68e064fa06820a715adacad21630"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a945f68e064fa06820a715adacad21630">monte_carlo_propagation</a> (struct <a class="el" href="structPhase.html">Phase</a> *const p, const unsigned int nsteps)</td></tr>
<tr class="separator:a945f68e064fa06820a715adacad21630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c6da280a6e2ed6bbf5d93c65eae7298"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a9c6da280a6e2ed6bbf5d93c65eae7298">mc_polymer_iteration</a> (struct <a class="el" href="structPhase.html">Phase</a> *const p, const unsigned int nsteps, const unsigned int tuning_parameter)</td></tr>
<tr class="separator:a9c6da280a6e2ed6bbf5d93c65eae7298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeeba6c3bd69f6c804f9344566e2ceb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#aeeeba6c3bd69f6c804f9344566e2ceb4">trial_move_cm</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const uint64_t poly_type, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *const dx, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *const dy, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *const dz, <a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const rng_state)</td></tr>
<tr class="separator:aeeeba6c3bd69f6c804f9344566e2ceb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9fbbe94fad37c40c4b7915511f74b62"><td class="memItemLeft" align="right" valign="top"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#ad9fbbe94fad37c40c4b7915511f74b62">calc_delta_nonbonded_energy</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const <a class="el" href="structMonomer.html">Monomer</a> *const monomer, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dx, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dy, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dz, const unsigned int iwtype)</td></tr>
<tr class="separator:ad9fbbe94fad37c40c4b7915511f74b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a2dbc4b19342d62f1f945ae7d37c0e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#ae5a2dbc4b19342d62f1f945ae7d37c0e">mc_center_mass</a> (struct <a class="el" href="structPhase.html">Phase</a> *const p, const unsigned int nsteps, const unsigned int tuning_parameter)</td></tr>
<tr class="separator:ae5a2dbc4b19342d62f1f945ae7d37c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff132f31dfd8430e6beb52cbe6659d5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#aff132f31dfd8430e6beb52cbe6659d5d">mc_set_iteration</a> (struct <a class="el" href="structPhase.html">Phase</a> *const p, const unsigned int nsteps, const unsigned int tuning_parameter)</td></tr>
<tr class="separator:aff132f31dfd8430e6beb52cbe6659d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01df62be5f698c491d2a922f97c58f9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a01df62be5f698c491d2a922f97c58f9b">trial_move</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const uint64_t ipoly, const int ibead, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dx, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dy, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dz, const unsigned int iwtype, <a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const rng_state)</td></tr>
<tr class="memdesc:a01df62be5f698c491d2a922f97c58f9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate a trial move for the specified bead  <a href="mc_8h.html#a01df62be5f698c491d2a922f97c58f9b">More...</a><br /></td></tr>
<tr class="separator:a01df62be5f698c491d2a922f97c58f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a3d00387be38df540813485f41298b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#ac2a3d00387be38df540813485f41298b">calc_delta_energy</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const uint64_t ipoly, const <a class="el" href="structMonomer.html">Monomer</a> *monomer, const unsigned int ibead, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dx, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dy, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dz, const unsigned int iwtype)</td></tr>
<tr class="separator:ac2a3d00387be38df540813485f41298b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59635ac95bb7248f2f5ffb2fe3eec391"><td class="memItemLeft" align="right" valign="top"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a59635ac95bb7248f2f5ffb2fe3eec391">calc_delta_bonded_energy</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const <a class="el" href="structMonomer.html">Monomer</a> *monomer, const uint64_t ipoly, const unsigned int ibead, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dx, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dy, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dz)</td></tr>
<tr class="separator:a59635ac95bb7248f2f5ffb2fe3eec391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18d0c5085d287ce1bf83bebdceb026cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a18d0c5085d287ce1bf83bebdceb026cf">som_accept</a> (<a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const rng, const struct <a class="el" href="structPhase.html">Phase</a> *const p, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> delta_energy, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> modifier)</td></tr>
<tr class="memdesc:a18d0c5085d287ce1bf83bebdceb026cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the Metropolis acceptance criteria. Random number from <a class="el" href="rng_8h.html" title="Definition of pseudo random number generation wrappers for soma.">rng.h</a> - bool as in the macro in &lt;stdbool.h&gt; (valid for C99).  <a href="mc_8h.html#a18d0c5085d287ce1bf83bebdceb026cf">More...</a><br /></td></tr>
<tr class="separator:a18d0c5085d287ce1bf83bebdceb026cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7a696465358d976939eaea149a795e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#ae7a696465358d976939eaea149a795e0">trial_move_smc</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const uint64_t ipoly, const int ibead, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dx, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dy, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dz, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *smc_deltaE, const <a class="el" href="structMonomer.html">Monomer</a> *mybead, <a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const myrngstate, const unsigned int iwtype)</td></tr>
<tr class="memdesc:ae7a696465358d976939eaea149a795e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smart Monte-Carlo (SMC) move. Calculate the displacement and the energy change from the forces.  <a href="mc_8h.html#ae7a696465358d976939eaea149a795e0">More...</a><br /></td></tr>
<tr class="separator:ae7a696465358d976939eaea149a795e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af77bbd51171e1a9916ab2dd4cfcc7a3c"><td class="memItemLeft" align="right" valign="top"><a id="af77bbd51171e1a9916ab2dd4cfcc7a3c" name="af77bbd51171e1a9916ab2dd4cfcc7a3c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>propose_smc_move</b> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const uint64_t ipoly, unsigned const int ibead, const unsigned int iwtype, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> x, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> y, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> z, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> rx, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> ry, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> rz, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *delta_E_bond, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dx, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dy, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *dz)</td></tr>
<tr class="separator:af77bbd51171e1a9916ab2dd4cfcc7a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab86e34853780625c4666cbc2ec1ae184"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#ab86e34853780625c4666cbc2ec1ae184">add_bond_forces</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const uint64_t ipoly, unsigned const int ibead, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> x, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> y, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> z, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *fx, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *fy, <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *fz)</td></tr>
<tr class="memdesc:ab86e34853780625c4666cbc2ec1ae184"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate forces acting on a monomer resulting from all of its bonds.  <a href="mc_8h.html#ab86e34853780625c4666cbc2ec1ae184">More...</a><br /></td></tr>
<tr class="separator:ab86e34853780625c4666cbc2ec1ae184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a3234ab494149aebc23b6ec84e64ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#ac4a3234ab494149aebc23b6ec84e64ee">possible_move_area51</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> oldx, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> oldy, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> oldz, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dx, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dy, const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> dz, const int nonexact)</td></tr>
<tr class="separator:ac4a3234ab494149aebc23b6ec84e64ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a66de99fec81d4593d16f26be4409c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a4a66de99fec81d4593d16f26be4409c4">set_iteration_single_chain</a> (struct <a class="el" href="structPhase.html">Phase</a> *const p, const unsigned int nsteps, const unsigned int tuning_parameter, const int nonexact_area51, uint64_t chain_i)</td></tr>
<tr class="memdesc:a4a66de99fec81d4593d16f26be4409c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set iteration function used for one long chain, private function.  <a href="mc_8h.html#a4a66de99fec81d4593d16f26be4409c4">More...</a><br /></td></tr>
<tr class="separator:a4a66de99fec81d4593d16f26be4409c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7ab09cd10c58cb114b6a47080a6c89b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#aa7ab09cd10c58cb114b6a47080a6c89b">set_iteration_multi_chain</a> (struct <a class="el" href="structPhase.html">Phase</a> *const p, const unsigned int nsteps, const unsigned int tuning_parameter, const int nonexact_area51, const int start_chain)</td></tr>
<tr class="memdesc:aa7ab09cd10c58cb114b6a47080a6c89b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set iteration function for all the chains starting from start_chain, private function.  <a href="mc_8h.html#aa7ab09cd10c58cb114b6a47080a6c89b">More...</a><br /></td></tr>
<tr class="separator:aa7ab09cd10c58cb114b6a47080a6c89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b6b83c95e3014e1291ae5df6db3da3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mc_8h.html#a31b6b83c95e3014e1291ae5df6db3da3">set_iteration_possible_move</a> (const struct <a class="el" href="structPhase.html">Phase</a> *p, <a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const set_states, <a class="el" href="structMonomer.html">Monomer</a> *const beads, uint64_t chain_index, unsigned int iP, const int nonexact_area51, const unsigned int ibead, const unsigned int iwtype, unsigned int *accepted_moves_set_ptr)</td></tr>
<tr class="memdesc:a31b6b83c95e3014e1291ae5df6db3da3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Private function used together with set_iteration_multi_chain and set_iteration_single_chain.  <a href="mc_8h.html#a31b6b83c95e3014e1291ae5df6db3da3">More...</a><br /></td></tr>
<tr class="separator:a31b6b83c95e3014e1291ae5df6db3da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions required for any Monte-Carlo move of the system. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab86e34853780625c4666cbc2ec1ae184" name="ab86e34853780625c4666cbc2ec1ae184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab86e34853780625c4666cbc2ec1ae184">&#9670;&#160;</a></span>add_bond_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_bond_forces </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>ipoly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const int&#160;</td>
          <td class="paramname"><em>ibead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>fy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>fz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate forces acting on a monomer resulting from all of its bonds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">ipoly</td><td><a class="el" href="structPolymer.html" title="Polymer information.">Polymer</a> of moving bead </td></tr>
    <tr><td class="paramname">ibead</td><td><a class="el" href="structMonomer.html" title="Monomer struct contains spatial position and type.">Monomer</a> of moving bead </td></tr>
    <tr><td class="paramname">x</td><td>coordinate </td></tr>
    <tr><td class="paramname">y</td><td>coordinate </td></tr>
    <tr><td class="paramname">z</td><td>coordinate </td></tr>
    <tr><td class="paramname">fx</td><td>x component of forces </td></tr>
    <tr><td class="paramname">fy</td><td>y component of forces </td></tr>
    <tr><td class="paramname">fz</td><td>z component of forces</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>forces acting on the provided position (x,y,z) returned as: fx,fy,fz.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>coordinates (x,y,z) are passed as a parameter and not taken from the configuration to enable the computation of forces after and before the move with this same function. </dd></dl>

</div>
</div>
<a id="a59635ac95bb7248f2f5ffb2fe3eec391" name="a59635ac95bb7248f2f5ffb2fe3eec391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59635ac95bb7248f2f5ffb2fe3eec391">&#9670;&#160;</a></span>calc_delta_bonded_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> calc_delta_bonded_energy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMonomer.html">Monomer</a> *&#160;</td>
          <td class="paramname"><em>monomer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>ipoly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>ibead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the bonded energy difference using the NEW2 bond structure for a moved bead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>configuration </td></tr>
    <tr><td class="paramname">monomer</td><td>Pointer to old Position of the <a class="el" href="structMonomer.html" title="Monomer struct contains spatial position and type.">Monomer</a>. </td></tr>
    <tr><td class="paramname">ipoly</td><td>polymer of moving bead </td></tr>
    <tr><td class="paramname">ibead</td><td>monomer of moving bead </td></tr>
    <tr><td class="paramname">dx</td><td>proposed x move </td></tr>
    <tr><td class="paramname">dy</td><td>proposed y move </td></tr>
    <tr><td class="paramname">dz</td><td>proposed z move </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bonded energy difference of proposed move </dd></dl>

</div>
</div>
<a id="ac2a3d00387be38df540813485f41298b" name="ac2a3d00387be38df540813485f41298b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2a3d00387be38df540813485f41298b">&#9670;&#160;</a></span>calc_delta_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> calc_delta_energy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>ipoly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMonomer.html">Monomer</a> *&#160;</td>
          <td class="paramname"><em>monomer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>ibead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iwtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the energy difference for a trial move.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>configuration </td></tr>
    <tr><td class="paramname">ipoly</td><td>polymer of moving bead </td></tr>
    <tr><td class="paramname">monomer</td><td>Pointer to old monomer position. </td></tr>
    <tr><td class="paramname">ibead</td><td>monomer of moving bead </td></tr>
    <tr><td class="paramname">dx</td><td>proposed x move </td></tr>
    <tr><td class="paramname">dy</td><td>proposed y move </td></tr>
    <tr><td class="paramname">dz</td><td>proposed z move </td></tr>
    <tr><td class="paramname">iwtype</td><td>Type of the monomer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>energy difference of proposed move. In case the of an error NAN is returned. </dd></dl>

</div>
</div>
<a id="ad9fbbe94fad37c40c4b7915511f74b62" name="ad9fbbe94fad37c40c4b7915511f74b62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9fbbe94fad37c40c4b7915511f74b62">&#9670;&#160;</a></span>calc_delta_nonbonded_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> calc_delta_nonbonded_energy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMonomer.html">Monomer</a> *const&#160;</td>
          <td class="paramname"><em>monomer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iwtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the nonbonded energy of a given particle compared to a proposed move.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>System description </td></tr>
    <tr><td class="paramname">monomer</td><td>Original position of the proposed <a class="el" href="structMonomer.html" title="Monomer struct contains spatial position and type.">Monomer</a> </td></tr>
    <tr><td class="paramname">dx</td><td>Proposed move in X direction. </td></tr>
    <tr><td class="paramname">dy</td><td>Proposed move in Y direction. </td></tr>
    <tr><td class="paramname">dz</td><td>Proposed move in Z direction. </td></tr>
    <tr><td class="paramname">iwtype</td><td>Type of the particle to move. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Calculated nonbonded energy difference. In case the of an error NAN is returned. </dd></dl>

</div>
</div>
<a id="ae5a2dbc4b19342d62f1f945ae7d37c0e" name="ae5a2dbc4b19342d62f1f945ae7d37c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a2dbc4b19342d62f1f945ae7d37c0e">&#9670;&#160;</a></span>mc_center_mass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mc_center_mass </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tuning_parameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Monte-Carlo move: diffusion of the center of mass for entire molecules.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">nsteps</td><td>#steps to perform with the system. </td></tr>
    <tr><td class="paramname">tuning_parameter</td><td>Parameter for ACC kernels. (vector_length) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code. Returns not equal to zero of an error occured. </dd></dl>

</div>
</div>
<a id="a9c6da280a6e2ed6bbf5d93c65eae7298" name="a9c6da280a6e2ed6bbf5d93c65eae7298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c6da280a6e2ed6bbf5d93c65eae7298">&#9670;&#160;</a></span>mc_polymer_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mc_polymer_iteration </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tuning_parameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Monte-Carlo move of the configuration using the parallel iteration of polymers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">nsteps</td><td>#steps to perform with the system. </td></tr>
    <tr><td class="paramname">tuning_parameter</td><td>Parameter for ACC kernels. (vector_length) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code. Returns not equal to zero of an error occured. </dd></dl>

</div>
</div>
<a id="aff132f31dfd8430e6beb52cbe6659d5d" name="aff132f31dfd8430e6beb52cbe6659d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff132f31dfd8430e6beb52cbe6659d5d">&#9670;&#160;</a></span>mc_set_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mc_set_iteration </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tuning_parameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Monte-Carlo move of the configuration using the parallel iteration of polymers and independet sets inside each molecule.</p>
<p >Via this two level parallelism a better saturation of GPUs can be achieved. (More parallel set the same system.) In addition, the coalesence of memory access is optimized. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">nsteps</td><td>#steps to perform with the system. </td></tr>
    <tr><td class="paramname">tuning_parameter</td><td>Parameter for ACC kernels. (vector_length) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code. Returns not equal to zero of an error occured. </dd></dl>

</div>
</div>
<a id="a945f68e064fa06820a715adacad21630" name="a945f68e064fa06820a715adacad21630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a945f68e064fa06820a715adacad21630">&#9670;&#160;</a></span>monte_carlo_propagation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int monte_carlo_propagation </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nsteps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Main Monte-Carlo function.</p>
<p >Automatic selection of the Monte-Carlo algorithm and their execution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>System to propagate. </td></tr>
    <tr><td class="paramname">nsteps</td><td>Number of timesteps to execute. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Errorcode </dd></dl>

</div>
</div>
<a id="ac4a3234ab494149aebc23b6ec84e64ee" name="ac4a3234ab494149aebc23b6ec84e64ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a3234ab494149aebc23b6ec84e64ee">&#9670;&#160;</a></span>possible_move_area51()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int possible_move_area51 </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>oldx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>oldy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>oldz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nonexact</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Validates, whether a move for a particle from the old position, by a displacement of dx violates the forbidden area51. Such a violation can be caused by either the final position or by passing through a forbidden area. This is by sampling the move path with a length of p-&gt;max_safe_jump. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>System description. </td></tr>
    <tr><td class="paramname">oldx</td><td>Old position of particle X. </td></tr>
    <tr><td class="paramname">oldy</td><td>Old position of particle Y. </td></tr>
    <tr><td class="paramname">oldz</td><td>Old position of particle Z. </td></tr>
    <tr><td class="paramname">dx</td><td>Displacement of the particle X. </td></tr>
    <tr><td class="paramname">dy</td><td>Displacement of the particle Y. </td></tr>
    <tr><td class="paramname">dz</td><td>Displacement of the particle Z. </td></tr>
    <tr><td class="paramname">nonexact</td><td>Check is done nonexact. Set it to true, if you just want the end check, but better performance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Normal walls along the coordinate axis are correctly filtered. But if the forbidden area is made up by boxes meeting edge to edge particle can and will pass through. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>True if move is allowed. False otherwise. </dd></dl>

</div>
</div>
<a id="aa7ab09cd10c58cb114b6a47080a6c89b" name="aa7ab09cd10c58cb114b6a47080a6c89b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7ab09cd10c58cb114b6a47080a6c89b">&#9670;&#160;</a></span>set_iteration_multi_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_iteration_multi_chain </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tuning_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nonexact_area51</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>start_chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set iteration function for all the chains starting from start_chain, private function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">nsteps</td><td>#steps to perform with the system. </td></tr>
    <tr><td class="paramname">tuning_parameter</td><td>Parameter for ACC kernels. (vector_length) </td></tr>
    <tr><td class="paramname">nonexact_area51</td><td>The exact check of area51 </td></tr>
    <tr><td class="paramname">start_chain</td><td>the starting index of the chains to be handled with this function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code. Returns either pgi error or domain error. </dd></dl>

</div>
</div>
<a id="a31b6b83c95e3014e1291ae5df6db3da3" name="a31b6b83c95e3014e1291ae5df6db3da3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b6b83c95e3014e1291ae5df6db3da3">&#9670;&#160;</a></span>set_iteration_possible_move()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_iteration_possible_move </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const&#160;</td>
          <td class="paramname"><em>set_states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMonomer.html">Monomer</a> *const&#160;</td>
          <td class="paramname"><em>beads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>chain_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>iP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nonexact_area51</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>ibead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iwtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>accepted_moves_set_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Private function used together with set_iteration_multi_chain and set_iteration_single_chain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration </td></tr>
    <tr><td class="paramname">set_states</td><td>The set states of the selected polymer </td></tr>
    <tr><td class="paramname">beads</td><td>ptr to the beads of the current polymer </td></tr>
    <tr><td class="paramname">chain_index</td><td>Index of the selected polymer </td></tr>
    <tr><td class="paramname">iP</td><td>Index of the current selected bead </td></tr>
    <tr><td class="paramname">nonexact_area51</td><td>The exact check of area51 </td></tr>
    <tr><td class="paramname">ibead</td><td>The selected bead </td></tr>
    <tr><td class="paramname">iwtype</td><td>The particle type of the selected particle </td></tr>
    <tr><td class="paramname">*accepted_moves_set_ptr</td><td>The pointer to the number of accepted_moves_set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error_flags[0] indicating domain error </dd></dl>

</div>
</div>
<a id="a4a66de99fec81d4593d16f26be4409c4" name="a4a66de99fec81d4593d16f26be4409c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a66de99fec81d4593d16f26be4409c4">&#9670;&#160;</a></span>set_iteration_single_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_iteration_single_chain </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>tuning_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nonexact_area51</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>chain_i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set iteration function used for one long chain, private function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">nsteps</td><td>#steps to perform with the system. </td></tr>
    <tr><td class="paramname">tuning_parameter</td><td>Parameter for ACC kernels. (vector_length) </td></tr>
    <tr><td class="paramname">nonexact_area51</td><td>The exact check of area51 </td></tr>
    <tr><td class="paramname">chain_i</td><td>The index of the chain to be handled </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code. Returns either pgi error or domain error. </dd></dl>

</div>
</div>
<a id="a18d0c5085d287ce1bf83bebdceb026cf" name="a18d0c5085d287ce1bf83bebdceb026cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18d0c5085d287ce1bf83bebdceb026cf">&#9670;&#160;</a></span>som_accept()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int som_accept </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const&#160;</td>
          <td class="paramname"><em>rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *const&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>delta_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a>&#160;</td>
          <td class="paramname"><em>modifier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculation of the Metropolis acceptance criteria. Random number from <a class="el" href="rng_8h.html" title="Definition of pseudo random number generation wrappers for soma.">rng.h</a> - bool as in the macro in &lt;stdbool.h&gt; (valid for C99). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">delta_energy</td><td>double ( E_new - E_old ), energy change after the intended movement on the random bead </td></tr>
    <tr><td class="paramname">p</td><td><a class="el" href="structPhase.html" title="All relevant information for a system configuration.">Phase</a> construct of the simulated system </td></tr>
    <tr><td class="paramname">rng</td><td>State of the rng to use </td></tr>
    <tr><td class="paramname">modifier</td><td>Additional factor multiplied to the acceptance probability. Must be in <picture><source srcset="form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [0,1] $" src="form_3.png"/></picture>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false according to the Metropolis criteria </dd></dl>

</div>
</div>
<a id="a01df62be5f698c491d2a922f97c58f9b" name="a01df62be5f698c491d2a922f97c58f9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01df62be5f698c491d2a922f97c58f9b">&#9670;&#160;</a></span>trial_move()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trial_move </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>ipoly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ibead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iwtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const&#160;</td>
          <td class="paramname"><em>rng_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate a trial move for the specified bead </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td><a class="el" href="structPhase.html" title="All relevant information for a system configuration.">Phase</a> configuration, in which the trial move is proposed </td></tr>
    <tr><td class="paramname">ipoly</td><td>Local polymer id of the move </td></tr>
    <tr><td class="paramname">ibead</td><td><a class="el" href="structMonomer.html" title="Monomer struct contains spatial position and type.">Monomer</a> id of the move </td></tr>
    <tr><td class="paramname">dx</td><td>memory for the resulting x proposal. </td></tr>
    <tr><td class="paramname">dy</td><td>memory for the resulting x proposal. </td></tr>
    <tr><td class="paramname">dz</td><td>memory for the resulting x proposal. </td></tr>
    <tr><td class="paramname">iwtype</td><td>Type of the particle to move. </td></tr>
    <tr><td class="paramname">rng_state</td><td>State of the RNG. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeeeba6c3bd69f6c804f9344566e2ceb4" name="aeeeba6c3bd69f6c804f9344566e2ceb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeeba6c3bd69f6c804f9344566e2ceb4">&#9670;&#160;</a></span>trial_move_cm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trial_move_cm </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>poly_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *const&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *const&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *const&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const&#160;</td>
          <td class="paramname"><em>rng_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Trial Move generation for simple center of mass moves.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>System description </td></tr>
    <tr><td class="paramname">poly_type</td><td>Type of the polymer to move. </td></tr>
    <tr><td class="paramname">dx</td><td>Output pointer to dx. </td></tr>
    <tr><td class="paramname">dy</td><td>Output pointer to dy. </td></tr>
    <tr><td class="paramname">dz</td><td>Output pointer to dz. </td></tr>
    <tr><td class="paramname">rng_state</td><td>State of the random number generator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae7a696465358d976939eaea149a795e0" name="ae7a696465358d976939eaea149a795e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7a696465358d976939eaea149a795e0">&#9670;&#160;</a></span>trial_move_smc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trial_move_smc </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structPhase.html">Phase</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>ipoly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ibead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="soma__config_8h.html#a59e3fe53d267a97ff32b8a16fea1f683">soma_scalar_t</a> *&#160;</td>
          <td class="paramname"><em>smc_deltaE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structMonomer.html">Monomer</a> *&#160;</td>
          <td class="paramname"><em>mybead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRNG__STATE.html">RNG_STATE</a> *const&#160;</td>
          <td class="paramname"><em>myrngstate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iwtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Smart Monte-Carlo (SMC) move. Calculate the displacement and the energy change from the forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Initialized configuration. </td></tr>
    <tr><td class="paramname">ipoly</td><td><a class="el" href="structPolymer.html" title="Polymer information.">Polymer</a> of moving bead </td></tr>
    <tr><td class="paramname">ibead</td><td><a class="el" href="structMonomer.html" title="Monomer struct contains spatial position and type.">Monomer</a> of moving bead </td></tr>
    <tr><td class="paramname">dx</td><td>proposed displacement calculated from the forces in x </td></tr>
    <tr><td class="paramname">dy</td><td>proposed displacement calculated from the forces in y </td></tr>
    <tr><td class="paramname">dz</td><td>proposed displacement calculated from the forces in z </td></tr>
    <tr><td class="paramname">smc_deltaE</td><td>energy change calculated from the forces acting on the bead before and after the proposed move. </td></tr>
    <tr><td class="paramname">mybead</td><td>Selected bead for the MC move </td></tr>
    <tr><td class="paramname">myrngstate</td><td>State of the random number generator, used to generate the random vector. </td></tr>
    <tr><td class="paramname">iwtype</td><td>Type of the monomer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>displacement of the proposed move (in dx,dy,dz components) and energy change of the proposed SMC move.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>only bonded forces are considered. Calculation of other forces (e.g. external fields) can be added in this function. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 7 2023 16:51:26 for My Project by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
