\hypertarget{mesh_8c}{}\doxysection{mesh.\+c File Reference}
\label{mesh_8c}\index{mesh.c@{mesh.c}}


Implementation of \mbox{\hyperlink{mesh_8h}{mesh.\+h}}.  


{\ttfamily \#include \char`\"{}mesh.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include \char`\"{}mpiroutines.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}soma\+\_\+config.\+h\char`\"{}}\newline
Include dependency graph for mesh.\+c\+:
% FIG 0
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{mesh_8c_ad6d1acfa339eda069015db9ac1f6af96}\label{mesh_8c_ad6d1acfa339eda069015db9ac1f6af96}} 
void {\bfseries communicate\+\_\+simple} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
\mbox{\Hypertarget{mesh_8c_aafb67c4ce1802333345eec15c2255ae7}\label{mesh_8c_aafb67c4ce1802333345eec15c2255ae7}} 
void {\bfseries communicate\+\_\+domain\+\_\+decomposition} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
void \mbox{\hyperlink{mesh_8c_ad8aa8f6d2d42d1f11ca7f8fdb2fdad3b}{communicate\+\_\+density\+\_\+fields}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
\mbox{\Hypertarget{mesh_8c_a600d32a9dfea6680072d43b251cdf323}\label{mesh_8c_a600d32a9dfea6680072d43b251cdf323}} 
int {\bfseries copy\+\_\+density\+\_\+32\+\_\+to\+\_\+16} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
int \mbox{\hyperlink{mesh_8c_a91f5d4bd90198f2aeb63f55c52964f49}{update\+\_\+density\+\_\+fields}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
void \mbox{\hyperlink{mesh_8c_aea6bc87873210c49b7321a9daccd879c}{update\+\_\+omega\+\_\+fields}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
void \mbox{\hyperlink{mesh_8c_a618d71a3f05754263864a225388aa1cb}{update\+\_\+omega\+\_\+fields\+\_\+scmf0}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
void \mbox{\hyperlink{mesh_8c_ac653af526188b98300934b90ea760073}{update\+\_\+omega\+\_\+fields\+\_\+scmf1}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of \mbox{\hyperlink{mesh_8h}{mesh.\+h}}. 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mesh_8c_ad8aa8f6d2d42d1f11ca7f8fdb2fdad3b}\label{mesh_8c_ad8aa8f6d2d42d1f11ca7f8fdb2fdad3b}} 
\index{mesh.c@{mesh.c}!communicate\_density\_fields@{communicate\_density\_fields}}
\index{communicate\_density\_fields@{communicate\_density\_fields}!mesh.c@{mesh.c}}
\doxysubsubsection{\texorpdfstring{communicate\_density\_fields()}{communicate\_density\_fields()}}
{\footnotesize\ttfamily void communicate\+\_\+density\+\_\+fields (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p }\end{DoxyParamCaption})}

Function to communicate the density field accross all ranks. If a domain decomposition is used, the communication pattern is accordingly adopted. 
\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} describing the system. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mesh_8c_a91f5d4bd90198f2aeb63f55c52964f49}\label{mesh_8c_a91f5d4bd90198f2aeb63f55c52964f49}} 
\index{mesh.c@{mesh.c}!update\_density\_fields@{update\_density\_fields}}
\index{update\_density\_fields@{update\_density\_fields}!mesh.c@{mesh.c}}
\doxysubsubsection{\texorpdfstring{update\_density\_fields()}{update\_density\_fields()}}
{\footnotesize\ttfamily int update\+\_\+density\+\_\+fields (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p }\end{DoxyParamCaption})}

Update the density fields $ \rho $ of the system. The field update fist sets all entries to zero. Then performs a loop over all polymers eg. monomers. The field itself is chosen according to the monomer type. Be shure that there is no additional type set otherwise the adressing fails. 
\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} configuration to update the densityfields. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
this call requires MPI collectives so call it on every MPI-\/core. 
\end{DoxyNote}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000003}{Todo}}]p-\/\texorpdfstring{$>$}{>}ncells as a temporary variable \end{DoxyRefDesc}
\mbox{\Hypertarget{mesh_8c_aea6bc87873210c49b7321a9daccd879c}\label{mesh_8c_aea6bc87873210c49b7321a9daccd879c}} 
\index{mesh.c@{mesh.c}!update\_omega\_fields@{update\_omega\_fields}}
\index{update\_omega\_fields@{update\_omega\_fields}!mesh.c@{mesh.c}}
\doxysubsubsection{\texorpdfstring{update\_omega\_fields()}{update\_omega\_fields()}}
{\footnotesize\ttfamily void update\+\_\+omega\+\_\+fields (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p }\end{DoxyParamCaption})}

Update the omega $ \omega$-\/fields of the system.

The function requires updated density fields, as a consequence update\+\_\+density\+\_\+fields is called. So the MPI collective characteristics are inherited. \begin{DoxyNote}{Note}
In accordance to the hamiltonian specified via the cmd line interface, the correct hamiltonian is selected.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} configuration to update the omega-\/fields. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
this call requires MPI collectives so call it on every MPI-\/core. 
\end{DoxyNote}
\mbox{\Hypertarget{mesh_8c_a618d71a3f05754263864a225388aa1cb}\label{mesh_8c_a618d71a3f05754263864a225388aa1cb}} 
\index{mesh.c@{mesh.c}!update\_omega\_fields\_scmf0@{update\_omega\_fields\_scmf0}}
\index{update\_omega\_fields\_scmf0@{update\_omega\_fields\_scmf0}!mesh.c@{mesh.c}}
\doxysubsubsection{\texorpdfstring{update\_omega\_fields\_scmf0()}{update\_omega\_fields\_scmf0()}}
{\footnotesize\ttfamily void update\+\_\+omega\+\_\+fields\+\_\+scmf0 (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p }\end{DoxyParamCaption})}

Function to calculate the omega fields for hamiltonian scmf0.


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} configuration to update. \[\frac{H}{k_BT } = \frac{\rho_0}{N_{ref}}\int_V D(\{r\}) \sum_i^{n_{types}}\frac{k_i}{2} \left(\phi_i(r)-s_i(r)\right)^2 + \sum_i^{n_{types}} \phi_i(r) f_i(r) + \frac{\kappa N_{ref}}{2} (\sum_{i} ^{n_{types}} \phi_i(r) - 1)^2 - \sum_{i<j}^{n_{types}} \frac{\chi_{i,j}N_{ref}}{4} (\phi_i(r) - \phi_j(r))^2 \] \[  \frac{\omega_k(c)}{k_BT} = \frac{N}{k_BT \rho_0 \Delta L^3}\frac{\partial H(c)}{k_BT \partial \phi_k} = \sum_i^{n_{types}} k_i\left(\phi_i(c)-s_i(c)\right) + f_k(c) + \kappa (\sum_i^{n_{types}} \phi_i(c)-1) - \sum_{i< k}^{n_{types}} \frac{\chi_{i,k}}{2} (\phi_k(c)-\phi_i(c))   \] \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
In case of the use of the density\+\_\+weights every $\phi_i$ is multiplied with its weight $w_i$. For this Hamiltonian weights differing from 1 are not recommended -- use SCMF1 instead. 
\end{DoxyNote}
\mbox{\Hypertarget{mesh_8c_ac653af526188b98300934b90ea760073}\label{mesh_8c_ac653af526188b98300934b90ea760073}} 
\index{mesh.c@{mesh.c}!update\_omega\_fields\_scmf1@{update\_omega\_fields\_scmf1}}
\index{update\_omega\_fields\_scmf1@{update\_omega\_fields\_scmf1}!mesh.c@{mesh.c}}
\doxysubsubsection{\texorpdfstring{update\_omega\_fields\_scmf1()}{update\_omega\_fields\_scmf1()}}
{\footnotesize\ttfamily void update\+\_\+omega\+\_\+fields\+\_\+scmf1 (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p }\end{DoxyParamCaption})}

Function to calculate the omega fields for hamiltonian scmf1.


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} configuration to update. \[\frac{H}{k_BT } = \frac{\rho_0}{N_{ref}}\int_V D(\{r\}) \sum_i^{n_{types}} \frac{k_i}{2} \left(\phi_i(r)-s_i(r)\right)^2+ \sum_i^{n_{types}} \phi_i(r) f_i(r) + \frac{\kappa N_{ref}}{2} \left(\sum_{i} ^{n_{types}} \phi_i(r) - 1\right)^2 + \sum_{i< j}^{n_{types}} \chi_{i,j}N_{ref} \phi_i(r) \phi_j(r) \] \[ \omega_k(c) = \frac{N_{ref}}{k_BT\rho_0 \Delta L^3}\frac{\partial H(c)}{\partial \phi_k} = \sum_i^{n_{types}} k_i\left(\phi_i(c)-s_i(c)\right)+ f_k(c) + \kappa \left(\sum_i^{n_{types}} \phi_i(c)-1\right) + \sum_{i< k}^{n_{types}} \chi_{i,k} \phi_i(c)   \] \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
In case of the use of the density\+\_\+weights every $\phi_i$ is multiplied with its weight $w_i$. 
\end{DoxyNote}
