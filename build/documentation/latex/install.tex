\hypertarget{install_CMake}{}\doxysection{SOMA uses CMake for Building}\label{install_CMake}
\begin{DoxyRefDesc}{Deprecated}
\item[\mbox{\hyperlink{deprecated__deprecated000006}{Deprecated}}]Former versions of SOMA used to ship with an HDF5 copy and a Unix Makefile. Both is now deprecated and no longer supported.\end{DoxyRefDesc}


\begin{DoxyWarning}{Warning}
Building SOMA is designed for out of source building and Unix/\+Linux systems only. Any other method is currently not supported or tested by the developers.
\end{DoxyWarning}
This page is intended to help the user install SOMA. Before the actual installation of the SOMA package, please install and setup the dependency of SOMA.\hypertarget{install_Dependency}{}\doxysubsection{Dependencies}\label{install_Dependency}
\hypertarget{install_MPI}{}\doxysubsubsection{Message Passing Interface (\+MPI)}\label{install_MPI}
SOMA is an HPC application utilizing multiple levels of parallelism. As a consequence, the Message Passing Interface MPI is used for parallelism across non-\/shared memory systems and across multiple GPUs. Because parallel IO is important, your version of MPI needs the parallel IO components.

We will not explain how to install MPI here, but installation instructions can be found for the different MPI implementations. Or you can install the corresponding package of your distribution. Just make sure parallel IO is supported.

For example\+:
\begin{DoxyItemize}
\item \href{www.open-mpi.org}{\texttt{ Open\+MPI }}
\item \href{www.mpich.org}{\texttt{ MPICH }}
\end{DoxyItemize}\hypertarget{install_HDF5}{}\doxysubsubsection{HDF5 Library}\label{install_HDF5}
HDF5 is a data format to store complex binary data in convenient containers. SOMA uses the functionality to read and write configurational and analysis data. In addition, to the easy to use and flexible binary containers HDF5 supports parallel IO via the MPI parallel IO interface. SOMA uses this functionality intensively and would not work without it.

In this section the basic installation of hdf5 is explained. To get the newest version of the library you can download directly from the \href{https://www.hdfgroup.org/}{\texttt{ hdf5group}}. You can find the download page \href{https://www.hdfgroup.org/downloads/}{\texttt{ here }}. For more information and especially also parallel build questions refer the hdf5 \href{ https://www.hdfgroup.org/HDF5-FAQ.html}{\texttt{ FAQ}}.

SOMA has been tested with HDF5 version 1.\+8.\+16. And here I will briefly explain how to install hdf5. You may follow them, or find your own way to install a parallel version of hdf5.


\begin{DoxyItemize}
\item The first step is to download and unpack the source from the HDF5 group.
\item Configure you MPI wrappers such that \char`\"{}mpicc\char`\"{} calls the compiler you want.
\item Enter the directory of the source.
\item Configure the build 
\begin{DoxyCode}{0}
\DoxyCodeLine{./configure CC=mpicc -\/-\/enable-\/parallel -\/-\/prefix=/path/to/hdf5install}

\end{DoxyCode}

\item Compile hdf5. That may take a while. 
\begin{DoxyCode}{0}
\DoxyCodeLine{make}

\end{DoxyCode}

\item Install HDF5 
\begin{DoxyCode}{0}
\DoxyCodeLine{make install}

\end{DoxyCode}

\end{DoxyItemize}\hypertarget{install_H5PY}{}\doxysubsubsection{Python HDF5 Binding}\label{install_H5PY}
For several of the python scripts, which are required to configure input scripts for SOMA the \char`\"{}h5py\char`\"{} library is required. Some of the scripts may also be helpful to analyze the results produced by SOMA.

Although, for running SOMA on a server you don\textquotesingle{}t need this library. But you will need some machine with this library. You can obtain via your package manager or download from \href{http://www.h5py.org/}{\texttt{ here}} and install it yourself.\hypertarget{install_Build}{}\doxysubsection{Building SOMA.}\label{install_Build}
SOMA is designed for the out of source compilation using CMake. So CMake is required to build SOMA. This section will step by step guide you to build and install SOMA.


\begin{DoxyItemize}
\item Git checkout your desired branch our tag of SOMA. Suggested is the latest tag or the \char`\"{}master\char`\"{} branch. 
\begin{DoxyCode}{0}
\DoxyCodeLine{git checkout master}

\end{DoxyCode}

\item Create your build directory. And enter it. 
\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir build}
\DoxyCodeLine{cd build}

\end{DoxyCode}

\item Configure CMake. This step depends on the type of build\+:
\begin{DoxyItemize}
\item If you want a standard build with your standard compiler and you have system wide installed parallel hdf5. 
\begin{DoxyCode}{0}
\DoxyCodeLine{cmake -\/DCMAKE\_INSTALL\_PREFIX=/path/to/SOMAinstall ../}

\end{DoxyCode}

\item If you want to use a specific compiler, for example \char`\"{}pgcc\char`\"{} set it. 
\begin{DoxyCode}{0}
\DoxyCodeLine{export CC=my\_compiler}
\DoxyCodeLine{cmake -\/DCMAKE\_INSTALL\_PREFIX=/path/to/SOMAinstall ../}

\end{DoxyCode}

\item If you are not using a system wide HDF5 installation (refer \mbox{\hyperlink{install_HDF5}{HDF5 Library}}) set the \char`\"{}\+HDF5\+\_\+\+ROOT\char`\"{} variable. 
\begin{DoxyCode}{0}
\DoxyCodeLine{HDF5\_ROOT=/path/to/hdf5install cmake -\/DCMAKE\_INSTALL\_PREFIX=/path/to/SOMAinstall ../}

\end{DoxyCode}
 It is important that the path is HDF5\+\_\+\+ROOT is absolute. \begin{DoxyNote}{Note}
Sometimes problems occur and the wrong library of hdf5 is found. Try to guide cmake appropriately.
\end{DoxyNote}

\item Now you can easily modify the options of SOMA build using 
\begin{DoxyCode}{0}
\DoxyCodeLine{ccmake .}

\end{DoxyCode}

\end{DoxyItemize}
\item Build SOMA\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{make}

\end{DoxyCode}

\item Install SOMA\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{make install}

\end{DoxyCode}

\end{DoxyItemize}

Now you find the SOMA executables at \char`\"{}/path/to/\+SOMAinstall/bin\char`\"{} and if you haven\textquotesingle{}t deactivated the installation of the python scripts you can find them at \char`\"{}/path/to/\+SOMAinstall/python-\/script\char`\"{}. You may want to set your PATH accordingly.\hypertarget{install_Doc}{}\doxysubsubsection{Compiling the Documentation}\label{install_Doc}
To compile the documentation you need doxygen and then can run in the build directory 
\begin{DoxyCode}{0}
\DoxyCodeLine{make doc }

\end{DoxyCode}
 As a result, you find a html and a latex documentation in the \char`\"{}documentation\char`\"{} folder. \begin{DoxyNote}{Note}
For building the documentation a working Doxygen and Dot installation is needed.
\end{DoxyNote}
\hypertarget{install_Server}{}\doxysection{Building on Known Severs}\label{install_Server}
For the common servers we have access to and we use. There are scripts that help building and running SOMA. Those scripts can be found in the \char`\"{}setups\char`\"{} directory of SOMA. They are intended to be source before a building or running SOMA.\hypertarget{install_taurus}{}\doxysubsection{Compilation on the taurus Cluster (\+TU-\/\+Dresden)}\label{install_taurus}
The taurus cluster in dresden is ready to be used with SOMA. The modules required for the installation and running can be found in the file \char`\"{}taurus.\+sh\char`\"{}. As a consequence, sourcing this files 
\begin{DoxyCode}{0}
\DoxyCodeLine{source taurus.sh }

\end{DoxyCode}
 should set up the correct environment for compiling and running SOMA. The HDF5 on taurus is not suitable for our purpose. So you need to build your own parallel version yourself.\hypertarget{install_jureca}{}\doxysubsection{Compilation on the jureca Cluster (\+HPC Jülich)}\label{install_jureca}
Similar to taurus the simple \char`\"{}jureca.\+sh\char`\"{} file can be sourced for compiling and running SOMA. 
\begin{DoxyCode}{0}
\DoxyCodeLine{source jureca.sh}

\end{DoxyCode}


The PGI tool chain of jureca does not have a suitable parallel hdf5 library. So you need to build one before you can build SOMA.\hypertarget{install_theorie}{}\doxysubsection{Compilation on our local GPU clusters. (\+GAU-\/\+Göttingen)}\label{install_theorie}
Our local GPU cluster (cuda01-\/cuda05) features a PGI compiler. So you can use it to run SOMA simulation on our GPUs. To setup the environment on the cluster use\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{source theorie.sh}

\end{DoxyCode}


There is no precompiled parallel HDF library, so you have to compile it. 