\hypertarget{soma__util_8c}{}\doxysection{soma\+\_\+util.\+c File Reference}
\label{soma__util_8c}\index{soma\_util.c@{soma\_util.c}}


Implementation of \mbox{\hyperlink{soma__util_8h}{soma\+\_\+util.\+h}}.  


{\ttfamily \#include \char`\"{}soma\+\_\+util.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include \char`\"{}cmdline.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}phase.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mpiroutines.\+h\char`\"{}}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
Include dependency graph for soma\+\_\+util.\+c\+:
% FIG 0
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
unsigned int \mbox{\hyperlink{soma__util_8c_a926cf7589ffec5ad59fae2284daba9e8}{get\+\_\+bond\+\_\+type}} (const uint32\+\_\+t info)
\item 
int \mbox{\hyperlink{soma__util_8c_a247311aa62c2f2069ee727db8cc257d5}{get\+\_\+offset}} (const int32\+\_\+t info)
\item 
unsigned int \mbox{\hyperlink{soma__util_8c_a8ec42caa056fe1198aac58b6d7a81726}{get\+\_\+end}} (const uint32\+\_\+t info)
\item 
uint32\+\_\+t \mbox{\hyperlink{soma__util_8c_a7b9cfa4d6ef084a18235ce7caf498009}{get\+\_\+info}} (const int offset, const unsigned int bond\+\_\+type, const unsigned int end)
\item 
int \mbox{\hyperlink{soma__util_8c_a9acca8fbe69dbd0197ea0ec7863a56b4}{get\+\_\+bondlist\+\_\+offset}} (const int32\+\_\+t info\+\_\+bl)
\item 
unsigned int \mbox{\hyperlink{soma__util_8c_a8525823db67a7ae687a687a639f82d35}{get\+\_\+particle\+\_\+type}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const uint64\+\_\+t i, const unsigned int j)
\item 
unsigned int \mbox{\hyperlink{soma__util_8c_ab54110fb5ce1ee6f09265f6cdb9de653}{get\+\_\+particle\+\_\+type\+\_\+of\+\_\+poly\+\_\+arch}} (const uint32\+\_\+t info\+\_\+bl)
\item 
uint32\+\_\+t \mbox{\hyperlink{soma__util_8c_ae0f659a68f41e6a2a548c1ed28f7f2a4}{get\+\_\+info\+\_\+bl}} (const unsigned int offset\+\_\+bl, const unsigned int type)
\item 
int \mbox{\hyperlink{soma__util_8c_a66fa8937a2d40efd013e5fb09fb1038f}{post\+\_\+process\+\_\+args}} (struct \mbox{\hyperlink{structsom__args}{som\+\_\+args}} $\ast$args, const unsigned int world\+\_\+rank)
\begin{DoxyCompactList}\small\item\em after argument parsing of SOMA, this function interpret contradictions and warnings for the user. \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{soma__util_8c_a0c925bb22d932bd6c2c5ba5d308d2262}{get\+\_\+number\+\_\+bond\+\_\+type}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const enum \mbox{\hyperlink{bond_8h_acb02e011150047bab1336f1cf96a627c}{Bondtype}} btype)
\begin{DoxyCompactList}\small\item\em Returns the number of bonds of specific type in the poly\+\_\+arch structure. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{soma__util_8c_a9fe35445dfd7bfd3630011c099beb42b}{reseed}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int seed)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of \mbox{\hyperlink{soma__util_8h}{soma\+\_\+util.\+h}}. 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{soma__util_8c_a926cf7589ffec5ad59fae2284daba9e8}\label{soma__util_8c_a926cf7589ffec5ad59fae2284daba9e8}} 
\index{soma\_util.c@{soma\_util.c}!get\_bond\_type@{get\_bond\_type}}
\index{get\_bond\_type@{get\_bond\_type}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_bond\_type()}{get\_bond\_type()}}
{\footnotesize\ttfamily unsigned int get\+\_\+bond\+\_\+type (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{info }\end{DoxyParamCaption})}

Function to extract the bond\+\_\+type for poly\+\_\+arch elements.


\begin{DoxyParams}{Parameters}
{\em info} & poly\+\_\+arch element. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Bond type in a bond list part. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Call only for bond list part of poly\+\_\+arch. 
\end{DoxyWarning}
\mbox{\Hypertarget{soma__util_8c_a9acca8fbe69dbd0197ea0ec7863a56b4}\label{soma__util_8c_a9acca8fbe69dbd0197ea0ec7863a56b4}} 
\index{soma\_util.c@{soma\_util.c}!get\_bondlist\_offset@{get\_bondlist\_offset}}
\index{get\_bondlist\_offset@{get\_bondlist\_offset}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_bondlist\_offset()}{get\_bondlist\_offset()}}
{\footnotesize\ttfamily int get\+\_\+bondlist\+\_\+offset (\begin{DoxyParamCaption}\item[{const int32\+\_\+t}]{info\+\_\+bl }\end{DoxyParamCaption})}

Get the offset for the poly\+\_\+arch array to start the bond list iteration.


\begin{DoxyParams}{Parameters}
{\em info\+\_\+bl} & poly\+\_\+arch element in the \mbox{\hyperlink{structMonomer}{Monomer}} region. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Offset to start the bond list iteration. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Call only for \mbox{\hyperlink{structMonomer}{Monomer}} region of poly\+\_\+arch. 
\end{DoxyWarning}
\mbox{\Hypertarget{soma__util_8c_a8ec42caa056fe1198aac58b6d7a81726}\label{soma__util_8c_a8ec42caa056fe1198aac58b6d7a81726}} 
\index{soma\_util.c@{soma\_util.c}!get\_end@{get\_end}}
\index{get\_end@{get\_end}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_end()}{get\_end()}}
{\footnotesize\ttfamily unsigned int get\+\_\+end (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{info }\end{DoxyParamCaption})}

Function to extract the end flag of a poly\+\_\+arch element.


\begin{DoxyParams}{Parameters}
{\em info} & poly\+\_\+arch element. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
End flag of the bond list. Stop iteration over the bond list, if it is non zero. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Call only for bond list part of poly\+\_\+arch. 
\end{DoxyWarning}
\mbox{\Hypertarget{soma__util_8c_a7b9cfa4d6ef084a18235ce7caf498009}\label{soma__util_8c_a7b9cfa4d6ef084a18235ce7caf498009}} 
\index{soma\_util.c@{soma\_util.c}!get\_info@{get\_info}}
\index{get\_info@{get\_info}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_info()}{get\_info()}}
{\footnotesize\ttfamily uint32\+\_\+t get\+\_\+info (\begin{DoxyParamCaption}\item[{const int}]{offset,  }\item[{const unsigned int}]{bond\+\_\+type,  }\item[{const unsigned int}]{end }\end{DoxyParamCaption})}

Function to compose a poly\+\_\+arch element in the bond list region


\begin{DoxyParams}{Parameters}
{\em offset} & Offset to the next neighbor. \\
\hline
{\em bond\+\_\+type} & Type of the bond. \\
\hline
{\em end} & Singal end of bond list. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Element for a poly\+\_\+arch bond list region. 
\end{DoxyReturn}
\mbox{\Hypertarget{soma__util_8c_ae0f659a68f41e6a2a548c1ed28f7f2a4}\label{soma__util_8c_ae0f659a68f41e6a2a548c1ed28f7f2a4}} 
\index{soma\_util.c@{soma\_util.c}!get\_info\_bl@{get\_info\_bl}}
\index{get\_info\_bl@{get\_info\_bl}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_info\_bl()}{get\_info\_bl()}}
{\footnotesize\ttfamily uint32\+\_\+t get\+\_\+info\+\_\+bl (\begin{DoxyParamCaption}\item[{const unsigned int}]{offset\+\_\+bl,  }\item[{const unsigned int}]{type }\end{DoxyParamCaption})}

Compose poly\+\_\+arch element for the


\begin{DoxyParams}{Parameters}
{\em offset\+\_\+bl} & Offset to bondlist to set. \\
\hline
{\em type} & Partile type to set. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Element for poly\+\_\+arch of the \mbox{\hyperlink{structMonomer}{Monomer}} region. 
\end{DoxyReturn}
\mbox{\Hypertarget{soma__util_8c_a0c925bb22d932bd6c2c5ba5d308d2262}\label{soma__util_8c_a0c925bb22d932bd6c2c5ba5d308d2262}} 
\index{soma\_util.c@{soma\_util.c}!get\_number\_bond\_type@{get\_number\_bond\_type}}
\index{get\_number\_bond\_type@{get\_number\_bond\_type}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_number\_bond\_type()}{get\_number\_bond\_type()}}
{\footnotesize\ttfamily unsigned int get\+\_\+number\+\_\+bond\+\_\+type (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const enum \mbox{\hyperlink{bond_8h_acb02e011150047bab1336f1cf96a627c}{Bondtype}}}]{btype }\end{DoxyParamCaption})}



Returns the number of bonds of specific type in the poly\+\_\+arch structure. 


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} of the system. \\
\hline
{\em btype} & Bondtype to count \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
This does not count the number of bonds in the system, only which bond types are used in the polyarch structure. 
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
Number of bonds in the poly\+\_\+arch structure. You may you that function to check if a specific bond type is present in the system. 
\end{DoxyReturn}
\mbox{\Hypertarget{soma__util_8c_a247311aa62c2f2069ee727db8cc257d5}\label{soma__util_8c_a247311aa62c2f2069ee727db8cc257d5}} 
\index{soma\_util.c@{soma\_util.c}!get\_offset@{get\_offset}}
\index{get\_offset@{get\_offset}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_offset()}{get\_offset()}}
{\footnotesize\ttfamily int get\+\_\+offset (\begin{DoxyParamCaption}\item[{const int32\+\_\+t}]{info }\end{DoxyParamCaption})}

Function to extract the offset you apply to your \mbox{\hyperlink{structMonomer}{Monomer}} to get the bonded neigbour.


\begin{DoxyParams}{Parameters}
{\em info} & poly\+\_\+arch element. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Offset to apply to your \mbox{\hyperlink{structMonomer}{Monomer}} to get the bonded neighbour. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Call only for bond list part of poly\+\_\+arch. 
\end{DoxyWarning}
\begin{DoxyNote}{Note}
We use here in32\+\_\+t instead uint32\+\_\+t, because for signed values, we need to set shift correct. 
\end{DoxyNote}
\mbox{\Hypertarget{soma__util_8c_a8525823db67a7ae687a687a639f82d35}\label{soma__util_8c_a8525823db67a7ae687a687a639f82d35}} 
\index{soma\_util.c@{soma\_util.c}!get\_particle\_type@{get\_particle\_type}}
\index{get\_particle\_type@{get\_particle\_type}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_particle\_type()}{get\_particle\_type()}}
{\footnotesize\ttfamily unsigned int get\+\_\+particle\+\_\+type (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const uint64\+\_\+t}]{i,  }\item[{const unsigned int}]{j }\end{DoxyParamCaption})}

Get particle type from a poly\+\_\+arch element or the \mbox{\hyperlink{structMonomer}{Monomer}} type polymer heavy struct, depending on where it is stored.


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} \\
\hline
{\em i} & local polymer index \\
\hline
{\em j} & monomer index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Particle type of the monomer. 
\end{DoxyReturn}
\mbox{\Hypertarget{soma__util_8c_ab54110fb5ce1ee6f09265f6cdb9de653}\label{soma__util_8c_ab54110fb5ce1ee6f09265f6cdb9de653}} 
\index{soma\_util.c@{soma\_util.c}!get\_particle\_type\_of\_poly\_arch@{get\_particle\_type\_of\_poly\_arch}}
\index{get\_particle\_type\_of\_poly\_arch@{get\_particle\_type\_of\_poly\_arch}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{get\_particle\_type\_of\_poly\_arch()}{get\_particle\_type\_of\_poly\_arch()}}
{\footnotesize\ttfamily unsigned int get\+\_\+particle\+\_\+type\+\_\+of\+\_\+poly\+\_\+arch (\begin{DoxyParamCaption}\item[{const uint32\+\_\+t}]{info\+\_\+bl }\end{DoxyParamCaption})}

Get particle type from a poly\+\_\+arch element or the \mbox{\hyperlink{structMonomer}{Monomer}} region.


\begin{DoxyParams}{Parameters}
{\em info\+\_\+bl} & poly\+\_\+arch element in the \mbox{\hyperlink{structMonomer}{Monomer}} region. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Particle type of the monomer. 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Call only for \mbox{\hyperlink{structMonomer}{Monomer}} region of poly\+\_\+arch. 
\end{DoxyWarning}
\mbox{\Hypertarget{soma__util_8c_a66fa8937a2d40efd013e5fb09fb1038f}\label{soma__util_8c_a66fa8937a2d40efd013e5fb09fb1038f}} 
\index{soma\_util.c@{soma\_util.c}!post\_process\_args@{post\_process\_args}}
\index{post\_process\_args@{post\_process\_args}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{post\_process\_args()}{post\_process\_args()}}
{\footnotesize\ttfamily int post\+\_\+process\+\_\+args (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structsom__args}{som\+\_\+args}} $\ast$}]{args,  }\item[{const unsigned int}]{world\+\_\+rank }\end{DoxyParamCaption})}



after argument parsing of SOMA, this function interpret contradictions and warnings for the user. 


\begin{DoxyParams}{Parameters}
{\em args} & Argument struct to interpret. \\
\hline
{\em world\+\_\+rank} & World rank of the calling rank. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code 
\end{DoxyReturn}
\mbox{\Hypertarget{soma__util_8c_a9fe35445dfd7bfd3630011c099beb42b}\label{soma__util_8c_a9fe35445dfd7bfd3630011c099beb42b}} 
\index{soma\_util.c@{soma\_util.c}!reseed@{reseed}}
\index{reseed@{reseed}!soma\_util.c@{soma\_util.c}}
\doxysubsubsection{\texorpdfstring{reseed()}{reseed()}}
{\footnotesize\ttfamily int reseed (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{seed }\end{DoxyParamCaption})}

Reseed the random number generators.


\begin{DoxyParams}{Parameters}
{\em p} & System to reseed. \\
\hline
{\em seed} & New seed for the system. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
