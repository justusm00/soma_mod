\hypertarget{mobility_8c}{}\doxysection{mobility.\+c File Reference}
\label{mobility_8c}\index{mobility.c@{mobility.c}}


Implementation of \mbox{\hyperlink{mobility_8h}{mobility.\+h}}.  


{\ttfamily \#include \char`\"{}mobility.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$hdf5.\+h$>$}\newline
{\ttfamily \#include \char`\"{}phase.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}io.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mesh.\+h\char`\"{}}\newline
Include dependency graph for mobility.\+c\+:
% FIG 0
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{mobility_8c_ab35041fe1671411430d411ad7e5f575a}{read\+\_\+mobility\+\_\+hdf5}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const hid\+\_\+t file\+\_\+id, const hid\+\_\+t plist\+\_\+id)
\item 
int \mbox{\hyperlink{mobility_8c_a42fdd41b3f2441fac9491b2af581f6ae}{write\+\_\+mobility\+\_\+hdf5}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const hid\+\_\+t file\+\_\+id, const hid\+\_\+t plist\+\_\+id)
\item 
int \mbox{\hyperlink{mobility_8c_a2f9e85beae3315aafd60fa035866e325}{copyin\+\_\+mobility}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p)
\item 
int \mbox{\hyperlink{mobility_8c_a3986acb72471fbf8a003faa0a760d25b}{copyout\+\_\+mobility}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p)
\item 
int \mbox{\hyperlink{mobility_8c_ada1266a6c39593dc06f7c4d0a6a3f172}{update\+\_\+self\+\_\+mobility}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p)
\item 
int \mbox{\hyperlink{mobility_8c_adb5697614a5ade952062cdc5a75b4da7}{free\+\_\+mobility}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p)
\item 
\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} \mbox{\hyperlink{mobility_8c_a93ea30403b30e8f4c16c0405c2c84d04}{get\+\_\+mobility\+\_\+modifier}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int particle\+\_\+type, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} x, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} y, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} z)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of \mbox{\hyperlink{mobility_8h}{mobility.\+h}}. 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mobility_8c_a2f9e85beae3315aafd60fa035866e325}\label{mobility_8c_a2f9e85beae3315aafd60fa035866e325}} 
\index{mobility.c@{mobility.c}!copyin\_mobility@{copyin\_mobility}}
\index{copyin\_mobility@{copyin\_mobility}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{copyin\_mobility()}{copyin\_mobility()}}
{\footnotesize\ttfamily int copyin\+\_\+mobility (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p }\end{DoxyParamCaption})}

Helper function to copy the mobility data to the device


\begin{DoxyParams}{Parameters}
{\em p} & Fully CPU initialized \mbox{\hyperlink{structPhase}{Phase}} struct \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\mbox{\Hypertarget{mobility_8c_a3986acb72471fbf8a003faa0a760d25b}\label{mobility_8c_a3986acb72471fbf8a003faa0a760d25b}} 
\index{mobility.c@{mobility.c}!copyout\_mobility@{copyout\_mobility}}
\index{copyout\_mobility@{copyout\_mobility}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{copyout\_mobility()}{copyout\_mobility()}}
{\footnotesize\ttfamily int copyout\+\_\+mobility (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p }\end{DoxyParamCaption})}

Helper function delete the mobility data from the device and copy it to the CPU memory


\begin{DoxyParams}{Parameters}
{\em p} & Fully CPU initialized \mbox{\hyperlink{structPhase}{Phase}} struct \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\mbox{\Hypertarget{mobility_8c_adb5697614a5ade952062cdc5a75b4da7}\label{mobility_8c_adb5697614a5ade952062cdc5a75b4da7}} 
\index{mobility.c@{mobility.c}!free\_mobility@{free\_mobility}}
\index{free\_mobility@{free\_mobility}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{free\_mobility()}{free\_mobility()}}
{\footnotesize\ttfamily int free\+\_\+mobility (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p }\end{DoxyParamCaption})}

Helper function to free the CPU memory resources of the mobility struct. The function gets automatically called by \mbox{\hyperlink{phase_8c_a4f9fac7804397bf8e34213da3a7b49c6}{free\+\_\+phase()}}.


\begin{DoxyParams}{Parameters}
{\em p} & Initialized \mbox{\hyperlink{structPhase}{Phase}} that is in the process of deallocating its resources. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\mbox{\Hypertarget{mobility_8c_a93ea30403b30e8f4c16c0405c2c84d04}\label{mobility_8c_a93ea30403b30e8f4c16c0405c2c84d04}} 
\index{mobility.c@{mobility.c}!get\_mobility\_modifier@{get\_mobility\_modifier}}
\index{get\_mobility\_modifier@{get\_mobility\_modifier}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{get\_mobility\_modifier()}{get\_mobility\_modifier()}}
{\footnotesize\ttfamily \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} get\+\_\+mobility\+\_\+modifier (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{particle\+\_\+type,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{x,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{y,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{z }\end{DoxyParamCaption})}

Actual function to calculate the mobility modifier.

This function return a probability that needs be multiplied to acceptance function.

\begin{DoxyNote}{Note}
this function calculates only the modifier for a single position. In order to get the full modification of pacc with respect to detailed balance, both old and new position have to be respected. The total modifier is than\+: $ m^* = \sqrt{ m(r) \cdot m(r+\Delta r)} $.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em p} & Fully initalized \mbox{\hyperlink{structPhase}{Phase}} struct \\
\hline
{\em particle\+\_\+type} & Type of the moving particle \\
\hline
{\em x} & x coordinate of the spatial position \\
\hline
{\em y} & y coordinate of the spatial position \\
\hline
{\em z} & z coordinate of the spatial position\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
modifier $ m(x,y,z) \in [0,1] $ 
\end{DoxyReturn}
\mbox{\Hypertarget{mobility_8c_ab35041fe1671411430d411ad7e5f575a}\label{mobility_8c_ab35041fe1671411430d411ad7e5f575a}} 
\index{mobility.c@{mobility.c}!read\_mobility\_hdf5@{read\_mobility\_hdf5}}
\index{read\_mobility\_hdf5@{read\_mobility\_hdf5}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{read\_mobility\_hdf5()}{read\_mobility\_hdf5()}}
{\footnotesize\ttfamily int read\+\_\+mobility\+\_\+hdf5 (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const hid\+\_\+t}]{file\+\_\+id,  }\item[{const hid\+\_\+t}]{plist\+\_\+id }\end{DoxyParamCaption})}

Helper function to read the mobility from the config HDF5 file.


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} describing the system \\
\hline
{\em file\+\_\+id} & File identifier of open HDF5 file. \\
\hline
{\em plist\+\_\+id} & Access properties to use. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\mbox{\Hypertarget{mobility_8c_ada1266a6c39593dc06f7c4d0a6a3f172}\label{mobility_8c_ada1266a6c39593dc06f7c4d0a6a3f172}} 
\index{mobility.c@{mobility.c}!update\_self\_mobility@{update\_self\_mobility}}
\index{update\_self\_mobility@{update\_self\_mobility}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{update\_self\_mobility()}{update\_self\_mobility()}}
{\footnotesize\ttfamily int update\+\_\+self\+\_\+mobility (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p }\end{DoxyParamCaption})}

Helper function to update the host with the mobility data


\begin{DoxyParams}{Parameters}
{\em p} & Fully initialized \mbox{\hyperlink{structPhase}{Phase}} struct \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\mbox{\Hypertarget{mobility_8c_a42fdd41b3f2441fac9491b2af581f6ae}\label{mobility_8c_a42fdd41b3f2441fac9491b2af581f6ae}} 
\index{mobility.c@{mobility.c}!write\_mobility\_hdf5@{write\_mobility\_hdf5}}
\index{write\_mobility\_hdf5@{write\_mobility\_hdf5}!mobility.c@{mobility.c}}
\doxysubsubsection{\texorpdfstring{write\_mobility\_hdf5()}{write\_mobility\_hdf5()}}
{\footnotesize\ttfamily int write\+\_\+mobility\+\_\+hdf5 (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const hid\+\_\+t}]{file\+\_\+id,  }\item[{const hid\+\_\+t}]{plist\+\_\+id }\end{DoxyParamCaption})}

Helper function to write the mobility to the config HDF5 file.


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} describing the system \\
\hline
{\em file\+\_\+id} & File identifier of open HDF5 file. \\
\hline
{\em plist\+\_\+id} & Access properties to use. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
