\hypertarget{polytype__conversion_8h_source}{}\doxysection{polytype\+\_\+conversion.\+h}
\label{polytype__conversion_8h_source}\index{polytype\_conversion.h@{polytype\_conversion.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{7 \textcolor{comment}{/* Copyright (C) 2016-\/2021 Ludwig Schneider}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{ This file is part of SOMA.}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{ SOMA is free software: you can redistribute it and/or modify}}
\DoxyCodeLine{12 \textcolor{comment}{ it under the terms of the GNU Lesser General Public License as published by}}
\DoxyCodeLine{13 \textcolor{comment}{ the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{14 \textcolor{comment}{ (at your option) any later version.}}
\DoxyCodeLine{15 \textcolor{comment}{}}
\DoxyCodeLine{16 \textcolor{comment}{ SOMA is distributed in the hope that it will be useful,}}
\DoxyCodeLine{17 \textcolor{comment}{ but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{18 \textcolor{comment}{ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{19 \textcolor{comment}{ GNU Lesser General Public License for more details.}}
\DoxyCodeLine{20 \textcolor{comment}{}}
\DoxyCodeLine{21 \textcolor{comment}{ You should have received a copy of the GNU Lesser General Public License}}
\DoxyCodeLine{22 \textcolor{comment}{ along with SOMA.  If not, see <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{23 \textcolor{comment}{*/}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#ifndef SOMA\_POLYTYPE\_CONVERSION\_H}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#define SOMA\_POLYTYPE\_CONVERSION\_H}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{soma__config_8h}{soma\_config.h}}"{}}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{soma__util_8h}{soma\_util.h}}"{}}}
\DoxyCodeLine{30 }
\DoxyCodeLine{33 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{structPolyConversion}{PolyConversion}} \{}
\DoxyCodeLine{34     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structPolyConversion_af696ac74e270216a4855ec89313d8a5f}{deltaMC}};       }
\DoxyCodeLine{35     uint8\_t *\mbox{\hyperlink{structPolyConversion_a612ee2795c4653d577733d04d9469629}{array}};             }
\DoxyCodeLine{36 }
\DoxyCodeLine{37     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_a7adb2d44b59a7bd434cf2fca53d04bd1}{input\_type}};   }
\DoxyCodeLine{38     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_a8d09cc2c5430e665bc3404d67bc07e7b}{output\_type}};  }
\DoxyCodeLine{39     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_a40013d43f4f7c46117d06faa350a7eaf}{reaction\_end}}; }
\DoxyCodeLine{40     \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} *\mbox{\hyperlink{structPolyConversion_a1b26658e05a353191a4bb1addd1f5fd1}{rate}};        }
\DoxyCodeLine{41     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_a2cc776c3153fff2d5ef7abbd09fc9336}{dependency\_ntype}};     }
\DoxyCodeLine{42     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_af987485cd49298e2ae695db903ac1c03}{dependency\_type\_offset}};       }
\DoxyCodeLine{43     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_a1dc696dd4d25bf1842d2e3036b6d4403}{dependency\_type}};      }
\DoxyCodeLine{44     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structPolyConversion_a4826b6f229fd6c5426d044103d2e2ae1}{len\_reactions}}; }
\DoxyCodeLine{45     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structPolyConversion_af0a822d7b4b5c5116fae514f41b30e24}{len\_dependencies}};      }
\DoxyCodeLine{46     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\mbox{\hyperlink{structPolyConversion_a4ea4e04b486d0fb0624f15455c6c0a70}{num\_conversions}}; }
\DoxyCodeLine{47 }
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \} \mbox{\hyperlink{structPolyConversion}{PolyConversion}};}
\DoxyCodeLine{50 }
\DoxyCodeLine{55 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_acf2399bed8f408401b99ea94beabfa37}{copyin\_poly\_conversion}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{56 }
\DoxyCodeLine{61 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a313463d16c9111749fa4792316165071}{copyout\_poly\_conversion}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{62 }
\DoxyCodeLine{67 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a2539c9442fed8e40e15f4acc7bf96f4f}{update\_self\_poly\_conversion}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p);}
\DoxyCodeLine{68 }
\DoxyCodeLine{76 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_abf247cfdee4c48c9922daaf05879e7b7}{read\_poly\_conversion\_hdf5}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} hid\_t file\_id, \textcolor{keyword}{const} hid\_t plist\_id);}
\DoxyCodeLine{77 }
\DoxyCodeLine{85 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_aa5a55150c408446a004f4a2eeab3ef37}{write\_poly\_conversion\_hdf5}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} hid\_t file\_id, \textcolor{keyword}{const} hid\_t plist\_id);}
\DoxyCodeLine{86 }
\DoxyCodeLine{92 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a22a423e19db255c2d00df0bf99f2f3e0}{free\_poly\_conversion}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{93 }
\DoxyCodeLine{99 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a89f65a473be2cecbfeb440d1e8759292}{convert\_polytypes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{100 }
\DoxyCodeLine{105 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a221a5ba395e05de4c5cef8ea63c94a2b}{fully\_convert\_polytypes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{106 }
\DoxyCodeLine{112 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a8802d6b7d864f43caeefea2da0266cf2}{partially\_convert\_polytypes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 }
\DoxyCodeLine{119 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_a4bd199708f489f077a277f8aad21deed}{simulated\_annealing}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 }
\DoxyCodeLine{126 \textcolor{keywordtype}{int} convert\_target(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{127 }
\DoxyCodeLine{134 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_ade7e21c1b0288d08e5f8e2b77e80542a}{print\_info}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 }
\DoxyCodeLine{142 \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} \mbox{\hyperlink{polytype__conversion_8c_a0fdc86884649ed1a34746a6692e937f9}{get\_density\_cost}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p, int64\_t * delta\_fields\_unified, uint64\_t * num\_target\_cells);}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 }
\DoxyCodeLine{150 \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} \mbox{\hyperlink{polytype__conversion_8c_a9f68119e5078899f0a4c0a50e6881426}{get\_composition\_cost}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p, int64\_t * delta\_fields\_unified, uint64\_t * num\_target\_cells);}
\DoxyCodeLine{151 }
\DoxyCodeLine{152 }
\DoxyCodeLine{157 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_aaa178026ff13e667efcb0104a55252e7}{comp}} (\textcolor{keyword}{const} \textcolor{keywordtype}{void} * elem1, \textcolor{keyword}{const} \textcolor{keywordtype}{void} * elem2);}
\DoxyCodeLine{158 }
\DoxyCodeLine{162 \textcolor{keywordtype}{int} \mbox{\hyperlink{polytype__conversion_8c_aba67a3236276601607fb52309571451e}{flip}}(\textcolor{keywordtype}{int} initial\_type);}
\DoxyCodeLine{163 }
\DoxyCodeLine{170 \textcolor{keywordtype}{void} \mbox{\hyperlink{polytype__conversion_8c_a1118de04b95dba73f0b692eb70579ad1}{get\_flip\_candidates}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} * p, int64\_t * poly\_isflippable, int64\_t * poly\_cell\_indices, int64\_t * poly\_cell\_num);}
\DoxyCodeLine{171 }
\DoxyCodeLine{181 \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} \mbox{\hyperlink{polytype__conversion_8c_a9d9debfbee86deef748effeb9ed810ee}{get\_density\_flip\_cost}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} * p, uint64\_t poly, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} initial\_type, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} final\_type, int64\_t * poly\_cell\_indices, int64\_t * poly\_cell\_num,int64\_t * delta\_fields\_unified);}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 }
\DoxyCodeLine{193 \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} \mbox{\hyperlink{polytype__conversion_8c_ace9d2ac9a24744b6d2de629f095d2958}{get\_composition\_flip\_cost}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} * p, uint64\_t poly, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} initial\_type, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} final\_type, int64\_t * poly\_cell\_indices, int64\_t * poly\_cell\_num,int64\_t * delta\_fields\_unified);}
\DoxyCodeLine{194 }
\DoxyCodeLine{204 \textcolor{keywordtype}{void} \mbox{\hyperlink{polytype__conversion_8c_aa104ae0926534b409e2ae5827a943e56}{update\_delta\_fields}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} * p, uint64\_t poly, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} initial\_type, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} final\_type, int64\_t * poly\_cell\_indices, int64\_t * poly\_cell\_num,int64\_t * delta\_fields\_unified);}
\DoxyCodeLine{205 }
\DoxyCodeLine{206 }
\DoxyCodeLine{225 \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} \mbox{\hyperlink{polytype__conversion_8c_afa22cf7e45f964df7041702b929fec16}{anneal\_polytypes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} * p,\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} total\_cost, uint64\_t num\_poly\_flippable, uint64\_t * total\_flip\_attempts, uint64\_t * total\_flips\_accepted,  int64\_t * poly\_cell\_indices, int64\_t * poly\_cell\_num, int64\_t * poly\_flippable\_indices,  int64\_t * delta\_fields\_unified, int64\_t * delta\_fields\_unified\_best,\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} * poly\_types,\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} * poly\_types\_best);}
\DoxyCodeLine{226 }
\DoxyCodeLine{227 }
\DoxyCodeLine{242 \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} \mbox{\hyperlink{polytype__conversion_8c_a6566c5228b6e15f3199d7d7f910d4c81}{flip\_polytypes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} * p,\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} total\_cost, uint64\_t num\_poly\_flippable, uint64\_t * total\_flip\_attempts,uint64\_t * total\_flips\_accepted, int64\_t * poly\_cell\_indices, int64\_t * poly\_cell\_num, int64\_t * poly\_flippable\_indices, int64\_t * delta\_fields\_unified, int64\_t * delta\_fields\_unified\_best,\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} * poly\_types ,\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} * poly\_types\_best);}
\DoxyCodeLine{243 }
\DoxyCodeLine{244 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//SOMA\_POLYTYPE\_CONVERSION\_H}}

\end{DoxyCode}
