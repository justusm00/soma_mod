\hypertarget{mpiroutines_8h_source}{}\doxysection{mpiroutines.\+h}
\label{mpiroutines_8h_source}\index{mpiroutines.h@{mpiroutines.h}}
\mbox{\hyperlink{mpiroutines_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* Copyright (C) 2016-\/2021 Ludwig Schneider}}
\DoxyCodeLine{2 \textcolor{comment}{   Copyright (C) 2016 Ulrich Welling}}
\DoxyCodeLine{3 \textcolor{comment}{   Copyright (C) 2016 Marcel Langenberg}}
\DoxyCodeLine{4 \textcolor{comment}{   Copyright (C) 2016 Fabien Leonforte}}
\DoxyCodeLine{5 \textcolor{comment}{   Copyright (C) 2016 Juan Orozco}}
\DoxyCodeLine{6 \textcolor{comment}{   Copyright (C) 2016 Yongzhi Ren}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{ This file is part of SOMA.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{ SOMA is free software: you can redistribute it and/or modify}}
\DoxyCodeLine{11 \textcolor{comment}{ it under the terms of the GNU Lesser General Public License as published by}}
\DoxyCodeLine{12 \textcolor{comment}{ the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{13 \textcolor{comment}{ (at your option) any later version.}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{ SOMA is distributed in the hope that it will be useful,}}
\DoxyCodeLine{16 \textcolor{comment}{ but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{17 \textcolor{comment}{ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{18 \textcolor{comment}{ GNU Lesser General Public License for more details.}}
\DoxyCodeLine{19 \textcolor{comment}{}}
\DoxyCodeLine{20 \textcolor{comment}{ You should have received a copy of the GNU Lesser General Public License}}
\DoxyCodeLine{21 \textcolor{comment}{ along with SOMA.  If not, see <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{22 \textcolor{comment}{*/}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#ifndef SOMA\_MPIROUTINES\_H}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define SOMA\_MPIROUTINES\_H}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{soma__config_8h}{soma\_config.h}}"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#if ( ENABLE\_MPI == 1 )}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <mpi.h>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//ENABLE\_MPI}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#ifdef ENABLE\_NCCL}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <nccl.h>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//ENABLE\_NCCL}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <stdbool.h>}}
\DoxyCodeLine{35 \textcolor{keyword}{struct }\mbox{\hyperlink{structPhase}{Phase}};}
\DoxyCodeLine{36 }
\DoxyCodeLine{59 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{structInfo__MPI}{Info\_MPI}} \{}
\DoxyCodeLine{60     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_ab920183f3ffba4148869189c8f25a5c3}{world\_rank}};             }
\DoxyCodeLine{61     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_a824cf31442b716cc9f6adad2c1427b2b}{world\_size}};             }
\DoxyCodeLine{62     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_af3e7b91998f2e082ffd40e7c490e4666}{sim\_size}};               }
\DoxyCodeLine{63     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_ac628a8ae90a49636e736040a3904984b}{sim\_rank}};               }
\DoxyCodeLine{64     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_a286b2bd0f748fbd766ef3de6b4ff7e58}{domain\_size}};            }
\DoxyCodeLine{65     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_ae1e8d27122b385761f1d8cb53e2cfe50}{domain\_rank}};            }
\DoxyCodeLine{66     \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_a457179350bfb612ae8484defb31f01c9}{gpu\_id}};                 }
\DoxyCodeLine{67 \textcolor{preprocessor}{\#if ( ENABLE\_MPI == 1 )}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     MPI\_Comm SOMA\_comm\_world;   }
\DoxyCodeLine{70     MPI\_Comm SOMA\_comm\_sim;     }
\DoxyCodeLine{71     MPI\_Comm SOMA\_comm\_domain;  }
\DoxyCodeLine{72 \textcolor{preprocessor}{\#ifdef ENABLE\_NCCL}}
\DoxyCodeLine{73     ncclComm\_t SOMA\_nccl\_world; }
\DoxyCodeLine{74     ncclComm\_t SOMA\_nccl\_sim;   }
\DoxyCodeLine{75     ncclComm\_t SOMA\_nccl\_domain;        }
\DoxyCodeLine{76 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//ENABLE\_NCCL}}
\DoxyCodeLine{77     MPI\_Status mpi\_status;      }
\DoxyCodeLine{78 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//ENABLE\_MPI}}
\DoxyCodeLine{80 \textcolor{comment}{}    double domain\_divergence\_sec;}
\DoxyCodeLine{82     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_a8864899aa7d2902f22896724c5b2a959}{domain\_divergence\_counter}};}
\DoxyCodeLine{83 \} \mbox{\hyperlink{structInfo__MPI}{Info\_MPI}};}
\DoxyCodeLine{84 }
\DoxyCodeLine{97 \textcolor{keywordtype}{int} \mbox{\hyperlink{mpiroutines_8h_a500bec134b7bace9302dbd2c3e4178c2}{init\_MPI}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *p);}
\DoxyCodeLine{98 }
\DoxyCodeLine{103 \textcolor{keywordtype}{int} \mbox{\hyperlink{mpiroutines_8h_ab8598e958dc9526f0395b46f0745a6b0}{finalize\_MPI}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structInfo__MPI}{Info\_MPI}} *mpi);}
\DoxyCodeLine{104 }
\DoxyCodeLine{111 \textcolor{keywordtype}{int} \mbox{\hyperlink{mpiroutines_8h_a894cf998f35c31c33b939c4f88d132b6}{check\_status\_on\_mpi}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keywordtype}{int} my\_status);}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{preprocessor}{\#if ( ENABLE\_MPI == 1 )}}
\DoxyCodeLine{119 \textcolor{keywordtype}{double} mpi\_divergence(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p);}
\DoxyCodeLine{120 }
\DoxyCodeLine{131 \textcolor{keywordtype}{int} collective\_global\_update(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p);}
\DoxyCodeLine{132 }
\DoxyCodeLine{142 \textcolor{keywordtype}{int} send\_polymer\_chain(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} uint64\_t poly\_id, \textcolor{keyword}{const} \textcolor{keywordtype}{int} destination, \textcolor{keyword}{const} MPI\_Comm comm);}
\DoxyCodeLine{143 }
\DoxyCodeLine{152 \textcolor{keywordtype}{int} recv\_polymer\_chain(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} source, \textcolor{keyword}{const} MPI\_Comm comm);}
\DoxyCodeLine{153 }
\DoxyCodeLine{163 \textcolor{keywordtype}{int} send\_mult\_polymers(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} destination, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} Nsends, \textcolor{keyword}{const} MPI\_Comm comm);}
\DoxyCodeLine{164 }
\DoxyCodeLine{172 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *recv\_mult\_polymers\_core(\textcolor{keyword}{const} \textcolor{keywordtype}{int} source, \textcolor{keyword}{const} MPI\_Comm comm,}
\DoxyCodeLine{173                                        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} Nsends, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} buffer\_length);}
\DoxyCodeLine{174 }
\DoxyCodeLine{182 \textcolor{keywordtype}{int} deserialize\_mult\_polymers(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} Nsends,}
\DoxyCodeLine{183                               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} buffer\_length, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *\textcolor{keyword}{const} buffer);}
\DoxyCodeLine{184 }
\DoxyCodeLine{193 \textcolor{keywordtype}{int} recv\_mult\_polymers(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} source, \textcolor{keyword}{const} MPI\_Comm comm);}
\DoxyCodeLine{194 }
\DoxyCodeLine{206 \textcolor{keywordtype}{int} load\_balance\_mpi\_ranks(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p);}
\DoxyCodeLine{207 }
\DoxyCodeLine{211 }
\DoxyCodeLine{217 \textcolor{keywordtype}{int} send\_domain\_chains(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} init);}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//ENABLE\_MPI}}
\DoxyCodeLine{220 }
\DoxyCodeLine{221 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{/*SOMA\_MPIROUTINES\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
