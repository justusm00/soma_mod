\hypertarget{soma__util_8h_source}{}\doxysection{soma\+\_\+util.\+h}
\label{soma__util_8h_source}\index{soma\_util.h@{soma\_util.h}}
\mbox{\hyperlink{soma__util_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* Copyright (C) 2016-\/2021 Ludwig Schneider}}
\DoxyCodeLine{2 \textcolor{comment}{}}
\DoxyCodeLine{3 \textcolor{comment}{ This file is part of SOMA.}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{ SOMA is free software: you can redistribute it and/or modify}}
\DoxyCodeLine{6 \textcolor{comment}{ it under the terms of the GNU Lesser General Public License as published by}}
\DoxyCodeLine{7 \textcolor{comment}{ the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{8 \textcolor{comment}{ (at your option) any later version.}}
\DoxyCodeLine{9 \textcolor{comment}{}}
\DoxyCodeLine{10 \textcolor{comment}{ SOMA is distributed in the hope that it will be useful,}}
\DoxyCodeLine{11 \textcolor{comment}{ but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{12 \textcolor{comment}{ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}}
\DoxyCodeLine{13 \textcolor{comment}{ GNU Lesser General Public License for more details.}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{ You should have received a copy of the GNU Lesser General Public License}}
\DoxyCodeLine{16 \textcolor{comment}{ along with SOMA.  If not, see <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{17 \textcolor{comment}{*/}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#ifndef SOMA\_UTIL\_H}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#define SOMA\_UTIL\_H}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{struct }\mbox{\hyperlink{structPhase}{Phase}};}
\DoxyCodeLine{23 \textcolor{keyword}{struct }\mbox{\hyperlink{structInfo__MPI}{Info\_MPI}};}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{soma__config_8h}{soma\_config.h}}"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{cmdline_8h}{cmdline.h}}"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{bond_8h}{bond.h}}"{}}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{monomer_8h}{monomer.h}}"{}}}
\DoxyCodeLine{30 }
\DoxyCodeLine{33 }
\DoxyCodeLine{35 \textcolor{keyword}{enum} \mbox{\hyperlink{soma__util_8h_a5b999d34f5aafaa8aa0bcb085bf4b478}{Hamiltonian}} \{}
\DoxyCodeLine{36     \mbox{\hyperlink{soma__util_8h_a5b999d34f5aafaa8aa0bcb085bf4b478a20b2507bde7a462337ec9f2f3cdd7b5f}{SCMF0}} = 0,                  }
\DoxyCodeLine{37     \mbox{\hyperlink{soma__util_8h_a5b999d34f5aafaa8aa0bcb085bf4b478a366642b528bc5147d52a52720ba4ea71}{SCMF1}} = 1,                  }
\DoxyCodeLine{38 \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{41 \textcolor{keyword}{enum} \mbox{\hyperlink{soma__util_8h_ad163d9aa6379ff1c19531a314cf905e7}{CartesionDirection}} \{}
\DoxyCodeLine{42     \mbox{\hyperlink{soma__util_8h_ad163d9aa6379ff1c19531a314cf905e7a58833a3110c570fb05130d40c365d1e4}{X}} = 0,                      }
\DoxyCodeLine{43     \mbox{\hyperlink{soma__util_8h_ad163d9aa6379ff1c19531a314cf905e7a5596231eabd6cf29050967d5ac83ad84}{Y}} = 1,                      }
\DoxyCodeLine{44     \mbox{\hyperlink{soma__util_8h_ad163d9aa6379ff1c19531a314cf905e7aa70478ce277ffc322f8e1e3418e07355}{Z}} = 2,                      }
\DoxyCodeLine{45 \};}
\DoxyCodeLine{46 }
\DoxyCodeLine{48 \textcolor{keyword}{enum} \mbox{\hyperlink{soma__util_8h_af9e1b45cd116d555eabb6c261ebecdbc}{MobilityEnum}} \{}
\DoxyCodeLine{49     \mbox{\hyperlink{soma__util_8h_af9e1b45cd116d555eabb6c261ebecdbca2ae21ac2573cf346fc5e1e119855fe0b}{DEFAULT\_MOBILITY}} = 0,       }
\DoxyCodeLine{50     \mbox{\hyperlink{soma__util_8h_af9e1b45cd116d555eabb6c261ebecdbca73b6a328b2c8bba36b8de4fdea8b1eed}{MULLER\_SMITH\_MOBILITY}} = 1,  }
\DoxyCodeLine{52     \mbox{\hyperlink{soma__util_8h_af9e1b45cd116d555eabb6c261ebecdbca51f0ad98f794c55a982f7416a2332c7e}{TANH\_MOBILITY}} = 2,}
\DoxyCodeLine{53 \};}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{60 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a926cf7589ffec5ad59fae2284daba9e8}{get\_bond\_type}}(\textcolor{keyword}{const} uint32\_t info);}
\DoxyCodeLine{61 }
\DoxyCodeLine{69 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{70 \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a247311aa62c2f2069ee727db8cc257d5}{get\_offset}}(\textcolor{keyword}{const} int32\_t info);}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{77 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a8ec42caa056fe1198aac58b6d7a81726}{get\_end}}(\textcolor{keyword}{const} uint32\_t info);}
\DoxyCodeLine{84 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{85 uint32\_t \mbox{\hyperlink{soma__util_8h_a7b9cfa4d6ef084a18235ce7caf498009}{get\_info}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} offset, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bond\_type, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} end);}
\DoxyCodeLine{91 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{92 \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a9acca8fbe69dbd0197ea0ec7863a56b4}{get\_bondlist\_offset}}(\textcolor{keyword}{const} int32\_t info\_bl);}
\DoxyCodeLine{99 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{100 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a8525823db67a7ae687a687a639f82d35}{get\_particle\_type}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} uint64\_t i, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j);}
\DoxyCodeLine{106 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{107 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_ab54110fb5ce1ee6f09265f6cdb9de653}{get\_particle\_type\_of\_poly\_arch}}(\textcolor{keyword}{const} uint32\_t info\_bl);}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#pragma acc routine seq}}
\DoxyCodeLine{114 uint32\_t \mbox{\hyperlink{soma__util_8h_ae0f659a68f41e6a2a548c1ed28f7f2a4}{get\_info\_bl}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} offset\_bl, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} type);}
\DoxyCodeLine{115 }
\DoxyCodeLine{121 \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a66fa8937a2d40efd013e5fb09fb1038f}{post\_process\_args}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structsom__args}{som\_args}} *args, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structInfo__MPI_ab920183f3ffba4148869189c8f25a5c3}{world\_rank}});}
\DoxyCodeLine{122 }
\DoxyCodeLine{129 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a0c925bb22d932bd6c2c5ba5d308d2262}{get\_number\_bond\_type}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keyword}{enum} \mbox{\hyperlink{bond_8h_acb02e011150047bab1336f1cf96a627c}{Bondtype}} btype);}
\DoxyCodeLine{130 }
\DoxyCodeLine{136 \textcolor{keywordtype}{int} \mbox{\hyperlink{soma__util_8h_a9fe35445dfd7bfd3630011c099beb42b}{reseed}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structPhase}{Phase}} *\textcolor{keyword}{const} p, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed);}
\DoxyCodeLine{137 }
\DoxyCodeLine{139 \textcolor{preprocessor}{\#define HDF5\_ERROR\_CHECK(status) if(status < 0)\{fprintf(stderr, "{}ERROR: HDF5 \%s:\%s:\%d: \%d\(\backslash\)n"{}},\_\_func\_\_, \_\_FILE\_\_, \_\_LINE\_\_,(int)status);return status;\}}
\DoxyCodeLine{140 }
\DoxyCodeLine{144 \textcolor{preprocessor}{\#define HDF5\_ERROR\_CHECK2(status,name) if(status < 0)\{fprintf(stderr, "{}ERROR: HDF5 Name:\%s \%s:\%d: \%d\(\backslash\)n"{}},name, \_\_FILE\_\_, \_\_LINE\_\_,(int)status);return status;\}}
\DoxyCodeLine{145 }
\DoxyCodeLine{148 \textcolor{preprocessor}{\#define MPI\_ERROR\_CHECK(status,msg) if(status != 0)\{fprintf(stderr, "{}ERROR: MPI abort Name: \%s \%s:\%d: \%d\(\backslash\)n"{}},msg, \_\_FILE\_\_, \_\_LINE\_\_,(int)status); ;exit(status);\}}
\DoxyCodeLine{149 }
\DoxyCodeLine{151 \textcolor{preprocessor}{\#define MALLOC\_ERROR\_CHECK( ptr, size ) if( (ptr) == NULL)\{fprintf(stderr,"{}MALLOC-\/ERROR: \%s:\%d size = \%lu\(\backslash\)n"{}}, \_\_FILE\_\_, \_\_LINE\_\_, (uint64\_t) (size)); return -\/1;\}}
\DoxyCodeLine{152 \textcolor{preprocessor}{\#pragma acc routine(calc\_bond\_length) seq}}
\DoxyCodeLine{153 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} calc\_bond\_length(\textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} x\_i, \textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} x\_j, \textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} box,}
\DoxyCodeLine{154                                              \textcolor{keyword}{const} \textcolor{keywordtype}{int} mic);}
\DoxyCodeLine{155 \textcolor{keyword}{inline} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} calc\_bond\_length(\textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} x\_i, \textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} x\_j, \textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} box,}
\DoxyCodeLine{156                                       \textcolor{keyword}{const} \textcolor{keywordtype}{int} mic)}
\DoxyCodeLine{157 \{}
\DoxyCodeLine{158     \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} r = x\_i -\/ x\_j + 0 * mic * box;        \textcolor{comment}{// after "{}+"{} to shut up compiler warnings}}
\DoxyCodeLine{159 \textcolor{preprocessor}{\#if ( ENABLE\_MIC == 1)}}
\DoxyCodeLine{160     \textcolor{keywordflow}{if} (mic)}
\DoxyCodeLine{161         \{}
\DoxyCodeLine{162 \textcolor{preprocessor}{\#if ( SINGLE\_PRECISION == 1)}}
\DoxyCodeLine{163             \textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} img = rintf(r / box);}
\DoxyCodeLine{164 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{165             \textcolor{keyword}{const} \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\_scalar\_t}} img = rint(r / box);}
\DoxyCodeLine{166 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//SINGLE\_PRECISION}}
\DoxyCodeLine{167             r -\/= img * box;}
\DoxyCodeLine{168         \}}
\DoxyCodeLine{169 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//ENABLE\_MIC}}
\DoxyCodeLine{170     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{171 \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{preprocessor}{\#endif                          }\textcolor{comment}{//SOMA\_UTIL\_H}}

\end{DoxyCode}
