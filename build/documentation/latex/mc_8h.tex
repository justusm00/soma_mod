\hypertarget{mc_8h}{}\doxysection{mc.\+h File Reference}
\label{mc_8h}\index{mc.h@{mc.h}}


Functions required for any Monte-\/\+Carlo move of the system.  


{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include \char`\"{}soma\+\_\+config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}rng.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}monomer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}polymer.\+h\char`\"{}}\newline
Include dependency graph for mc.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{mc_8h_a945f68e064fa06820a715adacad21630}{monte\+\_\+carlo\+\_\+propagation}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int nsteps)
\item 
int \mbox{\hyperlink{mc_8h_a9c6da280a6e2ed6bbf5d93c65eae7298}{mc\+\_\+polymer\+\_\+iteration}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int nsteps, const unsigned int tuning\+\_\+parameter)
\item 
void \mbox{\hyperlink{mc_8h_aeeeba6c3bd69f6c804f9344566e2ceb4}{trial\+\_\+move\+\_\+cm}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const uint64\+\_\+t poly\+\_\+type, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$const dx, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$const dy, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$const dz, \mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const rng\+\_\+state)
\item 
\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} \mbox{\hyperlink{mc_8h_ad9fbbe94fad37c40c4b7915511f74b62}{calc\+\_\+delta\+\_\+nonbonded\+\_\+energy}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$const monomer, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dx, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dy, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dz, const unsigned int iwtype)
\item 
int \mbox{\hyperlink{mc_8h_ae5a2dbc4b19342d62f1f945ae7d37c0e}{mc\+\_\+center\+\_\+mass}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int nsteps, const unsigned int tuning\+\_\+parameter)
\item 
int \mbox{\hyperlink{mc_8h_aff132f31dfd8430e6beb52cbe6659d5d}{mc\+\_\+set\+\_\+iteration}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int nsteps, const unsigned int tuning\+\_\+parameter)
\item 
void \mbox{\hyperlink{mc_8h_a01df62be5f698c491d2a922f97c58f9b}{trial\+\_\+move}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const uint64\+\_\+t ipoly, const int ibead, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dx, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dy, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dz, const unsigned int iwtype, \mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const rng\+\_\+state)
\begin{DoxyCompactList}\small\item\em calculate a trial move for the specified bead \end{DoxyCompactList}\item 
\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} \mbox{\hyperlink{mc_8h_ac2a3d00387be38df540813485f41298b}{calc\+\_\+delta\+\_\+energy}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const uint64\+\_\+t ipoly, const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$monomer, const unsigned int ibead, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dx, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dy, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dz, const unsigned int iwtype)
\item 
\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} \mbox{\hyperlink{mc_8h_a59635ac95bb7248f2f5ffb2fe3eec391}{calc\+\_\+delta\+\_\+bonded\+\_\+energy}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$monomer, const uint64\+\_\+t ipoly, const unsigned int ibead, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dx, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dy, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dz)
\item 
int \mbox{\hyperlink{mc_8h_a18d0c5085d287ce1bf83bebdceb026cf}{som\+\_\+accept}} (\mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const rng, const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} delta\+\_\+energy, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} modifier)
\begin{DoxyCompactList}\small\item\em Calculation of the Metropolis acceptance criteria. Random number from \mbox{\hyperlink{rng_8h}{rng.\+h}} -\/ bool as in the macro in \texorpdfstring{$<$}{<}stdbool.\+h\texorpdfstring{$>$}{>} (valid for C99). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mc_8h_ae7a696465358d976939eaea149a795e0}{trial\+\_\+move\+\_\+smc}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const uint64\+\_\+t ipoly, const int ibead, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dx, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dy, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dz, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$smc\+\_\+deltaE, const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$mybead, \mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const myrngstate, const unsigned int iwtype)
\begin{DoxyCompactList}\small\item\em Smart Monte-\/\+Carlo (SMC) move. Calculate the displacement and the energy change from the forces. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{mc_8h_af77bbd51171e1a9916ab2dd4cfcc7a3c}\label{mc_8h_af77bbd51171e1a9916ab2dd4cfcc7a3c}} 
void {\bfseries propose\+\_\+smc\+\_\+move} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const uint64\+\_\+t ipoly, unsigned const int ibead, const unsigned int iwtype, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} x, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} y, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} z, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} rx, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} ry, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} rz, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$delta\+\_\+\+E\+\_\+bond, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dx, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dy, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$dz)
\item 
void \mbox{\hyperlink{mc_8h_ab86e34853780625c4666cbc2ec1ae184}{add\+\_\+bond\+\_\+forces}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const uint64\+\_\+t ipoly, unsigned const int ibead, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} x, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} y, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} z, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$fx, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$fy, \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$fz)
\begin{DoxyCompactList}\small\item\em Calculate forces acting on a monomer resulting from all of its bonds. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{mc_8h_ac4a3234ab494149aebc23b6ec84e64ee}{possible\+\_\+move\+\_\+area51}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} oldx, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} oldy, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} oldz, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dx, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dy, const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} dz, const int nonexact)
\item 
int \mbox{\hyperlink{mc_8h_a4a66de99fec81d4593d16f26be4409c4}{set\+\_\+iteration\+\_\+single\+\_\+chain}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int nsteps, const unsigned int tuning\+\_\+parameter, const int nonexact\+\_\+area51, uint64\+\_\+t chain\+\_\+i)
\begin{DoxyCompactList}\small\item\em Set iteration function used for one long chain, private function. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{mc_8h_aa7ab09cd10c58cb114b6a47080a6c89b}{set\+\_\+iteration\+\_\+multi\+\_\+chain}} (struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const p, const unsigned int nsteps, const unsigned int tuning\+\_\+parameter, const int nonexact\+\_\+area51, const int start\+\_\+chain)
\begin{DoxyCompactList}\small\item\em Set iteration function for all the chains starting from start\+\_\+chain, private function. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{mc_8h_a31b6b83c95e3014e1291ae5df6db3da3}{set\+\_\+iteration\+\_\+possible\+\_\+move}} (const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$p, \mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const set\+\_\+states, \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$const beads, uint64\+\_\+t chain\+\_\+index, unsigned int iP, const int nonexact\+\_\+area51, const unsigned int ibead, const unsigned int iwtype, unsigned int $\ast$accepted\+\_\+moves\+\_\+set\+\_\+ptr)
\begin{DoxyCompactList}\small\item\em Private function used together with set\+\_\+iteration\+\_\+multi\+\_\+chain and set\+\_\+iteration\+\_\+single\+\_\+chain. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Functions required for any Monte-\/\+Carlo move of the system. 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mc_8h_ab86e34853780625c4666cbc2ec1ae184}\label{mc_8h_ab86e34853780625c4666cbc2ec1ae184}} 
\index{mc.h@{mc.h}!add\_bond\_forces@{add\_bond\_forces}}
\index{add\_bond\_forces@{add\_bond\_forces}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{add\_bond\_forces()}{add\_bond\_forces()}}
{\footnotesize\ttfamily void add\+\_\+bond\+\_\+forces (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const uint64\+\_\+t}]{ipoly,  }\item[{unsigned const int}]{ibead,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{x,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{y,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{z,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{fx,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{fy,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{fz }\end{DoxyParamCaption})}



Calculate forces acting on a monomer resulting from all of its bonds. 


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em ipoly} & \mbox{\hyperlink{structPolymer}{Polymer}} of moving bead \\
\hline
{\em ibead} & \mbox{\hyperlink{structMonomer}{Monomer}} of moving bead \\
\hline
{\em x} & coordinate \\
\hline
{\em y} & coordinate \\
\hline
{\em z} & coordinate \\
\hline
{\em fx} & x component of forces \\
\hline
{\em fy} & y component of forces \\
\hline
{\em fz} & z component of forces\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
forces acting on the provided position (x,y,z) returned as\+: fx,fy,fz.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
coordinates (x,y,z) are passed as a parameter and not taken from the configuration to enable the computation of forces after and before the move with this same function. 
\end{DoxyNote}
\mbox{\Hypertarget{mc_8h_a59635ac95bb7248f2f5ffb2fe3eec391}\label{mc_8h_a59635ac95bb7248f2f5ffb2fe3eec391}} 
\index{mc.h@{mc.h}!calc\_delta\_bonded\_energy@{calc\_delta\_bonded\_energy}}
\index{calc\_delta\_bonded\_energy@{calc\_delta\_bonded\_energy}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{calc\_delta\_bonded\_energy()}{calc\_delta\_bonded\_energy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} calc\+\_\+delta\+\_\+bonded\+\_\+energy (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$}]{monomer,  }\item[{const uint64\+\_\+t}]{ipoly,  }\item[{const unsigned int}]{ibead,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dx,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dy,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dz }\end{DoxyParamCaption})}

Calculate the bonded energy difference using the NEW2 bond structure for a moved bead.


\begin{DoxyParams}{Parameters}
{\em p} & configuration \\
\hline
{\em monomer} & Pointer to old Position of the \mbox{\hyperlink{structMonomer}{Monomer}}. \\
\hline
{\em ipoly} & polymer of moving bead \\
\hline
{\em ibead} & monomer of moving bead \\
\hline
{\em dx} & proposed x move \\
\hline
{\em dy} & proposed y move \\
\hline
{\em dz} & proposed z move \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bonded energy difference of proposed move 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_ac2a3d00387be38df540813485f41298b}\label{mc_8h_ac2a3d00387be38df540813485f41298b}} 
\index{mc.h@{mc.h}!calc\_delta\_energy@{calc\_delta\_energy}}
\index{calc\_delta\_energy@{calc\_delta\_energy}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{calc\_delta\_energy()}{calc\_delta\_energy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} calc\+\_\+delta\+\_\+energy (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const uint64\+\_\+t}]{ipoly,  }\item[{const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$}]{monomer,  }\item[{const unsigned int}]{ibead,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dx,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dy,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dz,  }\item[{const unsigned int}]{iwtype }\end{DoxyParamCaption})}

Calculate the energy difference for a trial move.


\begin{DoxyParams}{Parameters}
{\em p} & configuration \\
\hline
{\em ipoly} & polymer of moving bead \\
\hline
{\em monomer} & Pointer to old monomer position. \\
\hline
{\em ibead} & monomer of moving bead \\
\hline
{\em dx} & proposed x move \\
\hline
{\em dy} & proposed y move \\
\hline
{\em dz} & proposed z move \\
\hline
{\em iwtype} & Type of the monomer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
energy difference of proposed move. In case the of an error NAN is returned. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_ad9fbbe94fad37c40c4b7915511f74b62}\label{mc_8h_ad9fbbe94fad37c40c4b7915511f74b62}} 
\index{mc.h@{mc.h}!calc\_delta\_nonbonded\_energy@{calc\_delta\_nonbonded\_energy}}
\index{calc\_delta\_nonbonded\_energy@{calc\_delta\_nonbonded\_energy}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{calc\_delta\_nonbonded\_energy()}{calc\_delta\_nonbonded\_energy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} calc\+\_\+delta\+\_\+nonbonded\+\_\+energy (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$const}]{monomer,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dx,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dy,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dz,  }\item[{const unsigned int}]{iwtype }\end{DoxyParamCaption})}

Calculate the nonbonded energy of a given particle compared to a proposed move.


\begin{DoxyParams}{Parameters}
{\em p} & System description \\
\hline
{\em monomer} & Original position of the proposed \mbox{\hyperlink{structMonomer}{Monomer}} \\
\hline
{\em dx} & Proposed move in X direction. \\
\hline
{\em dy} & Proposed move in Y direction. \\
\hline
{\em dz} & Proposed move in Z direction. \\
\hline
{\em iwtype} & Type of the particle to move. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Calculated nonbonded energy difference. In case the of an error NAN is returned. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_ae5a2dbc4b19342d62f1f945ae7d37c0e}\label{mc_8h_ae5a2dbc4b19342d62f1f945ae7d37c0e}} 
\index{mc.h@{mc.h}!mc\_center\_mass@{mc\_center\_mass}}
\index{mc\_center\_mass@{mc\_center\_mass}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{mc\_center\_mass()}{mc\_center\_mass()}}
{\footnotesize\ttfamily int mc\+\_\+center\+\_\+mass (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{nsteps,  }\item[{const unsigned int}]{tuning\+\_\+parameter }\end{DoxyParamCaption})}

Monte-\/\+Carlo move\+: diffusion of the center of mass for entire molecules.


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em nsteps} & \#steps to perform with the system. \\
\hline
{\em tuning\+\_\+parameter} & Parameter for ACC kernels. (vector\+\_\+length) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code. Returns not equal to zero of an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_a9c6da280a6e2ed6bbf5d93c65eae7298}\label{mc_8h_a9c6da280a6e2ed6bbf5d93c65eae7298}} 
\index{mc.h@{mc.h}!mc\_polymer\_iteration@{mc\_polymer\_iteration}}
\index{mc\_polymer\_iteration@{mc\_polymer\_iteration}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{mc\_polymer\_iteration()}{mc\_polymer\_iteration()}}
{\footnotesize\ttfamily int mc\+\_\+polymer\+\_\+iteration (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{nsteps,  }\item[{const unsigned int}]{tuning\+\_\+parameter }\end{DoxyParamCaption})}

Monte-\/\+Carlo move of the configuration using the parallel iteration of polymers.


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em nsteps} & \#steps to perform with the system. \\
\hline
{\em tuning\+\_\+parameter} & Parameter for ACC kernels. (vector\+\_\+length) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code. Returns not equal to zero of an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_aff132f31dfd8430e6beb52cbe6659d5d}\label{mc_8h_aff132f31dfd8430e6beb52cbe6659d5d}} 
\index{mc.h@{mc.h}!mc\_set\_iteration@{mc\_set\_iteration}}
\index{mc\_set\_iteration@{mc\_set\_iteration}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{mc\_set\_iteration()}{mc\_set\_iteration()}}
{\footnotesize\ttfamily int mc\+\_\+set\+\_\+iteration (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{nsteps,  }\item[{const unsigned int}]{tuning\+\_\+parameter }\end{DoxyParamCaption})}

Monte-\/\+Carlo move of the configuration using the parallel iteration of polymers and independet sets inside each molecule.

Via this two level parallelism a better saturation of GPUs can be achieved. (More parallel set the same system.) In addition, the coalesence of memory access is optimized. 
\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em nsteps} & \#steps to perform with the system. \\
\hline
{\em tuning\+\_\+parameter} & Parameter for ACC kernels. (vector\+\_\+length) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code. Returns not equal to zero of an error occured. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_a945f68e064fa06820a715adacad21630}\label{mc_8h_a945f68e064fa06820a715adacad21630}} 
\index{mc.h@{mc.h}!monte\_carlo\_propagation@{monte\_carlo\_propagation}}
\index{monte\_carlo\_propagation@{monte\_carlo\_propagation}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{monte\_carlo\_propagation()}{monte\_carlo\_propagation()}}
{\footnotesize\ttfamily int monte\+\_\+carlo\+\_\+propagation (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{nsteps }\end{DoxyParamCaption})}

Main Monte-\/\+Carlo function.

Automatic selection of the Monte-\/\+Carlo algorithm and their execution. 
\begin{DoxyParams}{Parameters}
{\em p} & System to propagate. \\
\hline
{\em nsteps} & Number of timesteps to execute. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Errorcode 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_ac4a3234ab494149aebc23b6ec84e64ee}\label{mc_8h_ac4a3234ab494149aebc23b6ec84e64ee}} 
\index{mc.h@{mc.h}!possible\_move\_area51@{possible\_move\_area51}}
\index{possible\_move\_area51@{possible\_move\_area51}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{possible\_move\_area51()}{possible\_move\_area51()}}
{\footnotesize\ttfamily int possible\+\_\+move\+\_\+area51 (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{oldx,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{oldy,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{oldz,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dx,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dy,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{dz,  }\item[{const int}]{nonexact }\end{DoxyParamCaption})}

Validates, whether a move for a particle from the old position, by a displacement of dx violates the forbidden area51. Such a violation can be caused by either the final position or by passing through a forbidden area. This is by sampling the move path with a length of p-\/\texorpdfstring{$>$}{>}max\+\_\+safe\+\_\+jump. 
\begin{DoxyParams}{Parameters}
{\em p} & System description. \\
\hline
{\em oldx} & Old position of particle X. \\
\hline
{\em oldy} & Old position of particle Y. \\
\hline
{\em oldz} & Old position of particle Z. \\
\hline
{\em dx} & Displacement of the particle X. \\
\hline
{\em dy} & Displacement of the particle Y. \\
\hline
{\em dz} & Displacement of the particle Z. \\
\hline
{\em nonexact} & Check is done nonexact. Set it to true, if you just want the end check, but better performance. \\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
Normal walls along the coordinate axis are correctly filtered. But if the forbidden area is made up by boxes meeting edge to edge particle can and will pass through. 
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
True if move is allowed. False otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_aa7ab09cd10c58cb114b6a47080a6c89b}\label{mc_8h_aa7ab09cd10c58cb114b6a47080a6c89b}} 
\index{mc.h@{mc.h}!set\_iteration\_multi\_chain@{set\_iteration\_multi\_chain}}
\index{set\_iteration\_multi\_chain@{set\_iteration\_multi\_chain}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{set\_iteration\_multi\_chain()}{set\_iteration\_multi\_chain()}}
{\footnotesize\ttfamily int set\+\_\+iteration\+\_\+multi\+\_\+chain (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{nsteps,  }\item[{const unsigned int}]{tuning\+\_\+parameter,  }\item[{const int}]{nonexact\+\_\+area51,  }\item[{const int}]{start\+\_\+chain }\end{DoxyParamCaption})}



Set iteration function for all the chains starting from start\+\_\+chain, private function. 


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em nsteps} & \#steps to perform with the system. \\
\hline
{\em tuning\+\_\+parameter} & Parameter for ACC kernels. (vector\+\_\+length) \\
\hline
{\em nonexact\+\_\+area51} & The exact check of area51 \\
\hline
{\em start\+\_\+chain} & the starting index of the chains to be handled with this function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code. Returns either pgi error or domain error. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_a31b6b83c95e3014e1291ae5df6db3da3}\label{mc_8h_a31b6b83c95e3014e1291ae5df6db3da3}} 
\index{mc.h@{mc.h}!set\_iteration\_possible\_move@{set\_iteration\_possible\_move}}
\index{set\_iteration\_possible\_move@{set\_iteration\_possible\_move}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{set\_iteration\_possible\_move()}{set\_iteration\_possible\_move()}}
{\footnotesize\ttfamily int set\+\_\+iteration\+\_\+possible\+\_\+move (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{\mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const}]{set\+\_\+states,  }\item[{\mbox{\hyperlink{structMonomer}{Monomer}} $\ast$const}]{beads,  }\item[{uint64\+\_\+t}]{chain\+\_\+index,  }\item[{unsigned int}]{iP,  }\item[{const int}]{nonexact\+\_\+area51,  }\item[{const unsigned int}]{ibead,  }\item[{const unsigned int}]{iwtype,  }\item[{unsigned int $\ast$}]{accepted\+\_\+moves\+\_\+set\+\_\+ptr }\end{DoxyParamCaption})}



Private function used together with set\+\_\+iteration\+\_\+multi\+\_\+chain and set\+\_\+iteration\+\_\+single\+\_\+chain. 


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration \\
\hline
{\em set\+\_\+states} & The set states of the selected polymer \\
\hline
{\em beads} & ptr to the beads of the current polymer \\
\hline
{\em chain\+\_\+index} & Index of the selected polymer \\
\hline
{\em iP} & Index of the current selected bead \\
\hline
{\em nonexact\+\_\+area51} & The exact check of area51 \\
\hline
{\em ibead} & The selected bead \\
\hline
{\em iwtype} & The particle type of the selected particle \\
\hline
{\em $\ast$accepted\+\_\+moves\+\_\+set\+\_\+ptr} & The pointer to the number of accepted\+\_\+moves\+\_\+set \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
error\+\_\+flags\mbox{[}0\mbox{]} indicating domain error 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_a4a66de99fec81d4593d16f26be4409c4}\label{mc_8h_a4a66de99fec81d4593d16f26be4409c4}} 
\index{mc.h@{mc.h}!set\_iteration\_single\_chain@{set\_iteration\_single\_chain}}
\index{set\_iteration\_single\_chain@{set\_iteration\_single\_chain}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{set\_iteration\_single\_chain()}{set\_iteration\_single\_chain()}}
{\footnotesize\ttfamily int set\+\_\+iteration\+\_\+single\+\_\+chain (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const unsigned int}]{nsteps,  }\item[{const unsigned int}]{tuning\+\_\+parameter,  }\item[{const int}]{nonexact\+\_\+area51,  }\item[{uint64\+\_\+t}]{chain\+\_\+i }\end{DoxyParamCaption})}



Set iteration function used for one long chain, private function. 


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em nsteps} & \#steps to perform with the system. \\
\hline
{\em tuning\+\_\+parameter} & Parameter for ACC kernels. (vector\+\_\+length) \\
\hline
{\em nonexact\+\_\+area51} & The exact check of area51 \\
\hline
{\em chain\+\_\+i} & The index of the chain to be handled \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error code. Returns either pgi error or domain error. 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_a18d0c5085d287ce1bf83bebdceb026cf}\label{mc_8h_a18d0c5085d287ce1bf83bebdceb026cf}} 
\index{mc.h@{mc.h}!som\_accept@{som\_accept}}
\index{som\_accept@{som\_accept}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{som\_accept()}{som\_accept()}}
{\footnotesize\ttfamily int som\+\_\+accept (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const}]{rng,  }\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$const}]{p,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{delta\+\_\+energy,  }\item[{const \mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}}}]{modifier }\end{DoxyParamCaption})}



Calculation of the Metropolis acceptance criteria. Random number from \mbox{\hyperlink{rng_8h}{rng.\+h}} -\/ bool as in the macro in \texorpdfstring{$<$}{<}stdbool.\+h\texorpdfstring{$>$}{>} (valid for C99). 


\begin{DoxyParams}{Parameters}
{\em delta\+\_\+energy} & double ( E\+\_\+new -\/ E\+\_\+old ), energy change after the intended movement on the random bead \\
\hline
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} construct of the simulated system \\
\hline
{\em rng} & State of the rng to use \\
\hline
{\em modifier} & Additional factor multiplied to the acceptance probability. Must be in $ [0,1] $. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true or false according to the Metropolis criteria 
\end{DoxyReturn}
\mbox{\Hypertarget{mc_8h_a01df62be5f698c491d2a922f97c58f9b}\label{mc_8h_a01df62be5f698c491d2a922f97c58f9b}} 
\index{mc.h@{mc.h}!trial\_move@{trial\_move}}
\index{trial\_move@{trial\_move}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{trial\_move()}{trial\_move()}}
{\footnotesize\ttfamily void trial\+\_\+move (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const uint64\+\_\+t}]{ipoly,  }\item[{const int}]{ibead,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{dx,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{dy,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{dz,  }\item[{const unsigned int}]{iwtype,  }\item[{\mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const}]{rng\+\_\+state }\end{DoxyParamCaption})}



calculate a trial move for the specified bead 


\begin{DoxyParams}{Parameters}
{\em p} & \mbox{\hyperlink{structPhase}{Phase}} configuration, in which the trial move is proposed \\
\hline
{\em ipoly} & Local polymer id of the move \\
\hline
{\em ibead} & \mbox{\hyperlink{structMonomer}{Monomer}} id of the move \\
\hline
{\em dx} & memory for the resulting x proposal. \\
\hline
{\em dy} & memory for the resulting x proposal. \\
\hline
{\em dz} & memory for the resulting x proposal. \\
\hline
{\em iwtype} & Type of the particle to move. \\
\hline
{\em rng\+\_\+state} & State of the RNG. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mc_8h_aeeeba6c3bd69f6c804f9344566e2ceb4}\label{mc_8h_aeeeba6c3bd69f6c804f9344566e2ceb4}} 
\index{mc.h@{mc.h}!trial\_move\_cm@{trial\_move\_cm}}
\index{trial\_move\_cm@{trial\_move\_cm}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{trial\_move\_cm()}{trial\_move\_cm()}}
{\footnotesize\ttfamily void trial\+\_\+move\+\_\+cm (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const uint64\+\_\+t}]{poly\+\_\+type,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$const}]{dx,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$const}]{dy,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$const}]{dz,  }\item[{\mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const}]{rng\+\_\+state }\end{DoxyParamCaption})}

Trial Move generation for simple center of mass moves.


\begin{DoxyParams}{Parameters}
{\em p} & System description \\
\hline
{\em poly\+\_\+type} & Type of the polymer to move. \\
\hline
{\em dx} & Output pointer to dx. \\
\hline
{\em dy} & Output pointer to dy. \\
\hline
{\em dz} & Output pointer to dz. \\
\hline
{\em rng\+\_\+state} & State of the random number generator. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{mc_8h_ae7a696465358d976939eaea149a795e0}\label{mc_8h_ae7a696465358d976939eaea149a795e0}} 
\index{mc.h@{mc.h}!trial\_move\_smc@{trial\_move\_smc}}
\index{trial\_move\_smc@{trial\_move\_smc}!mc.h@{mc.h}}
\doxysubsubsection{\texorpdfstring{trial\_move\_smc()}{trial\_move\_smc()}}
{\footnotesize\ttfamily void trial\+\_\+move\+\_\+smc (\begin{DoxyParamCaption}\item[{const struct \mbox{\hyperlink{structPhase}{Phase}} $\ast$}]{p,  }\item[{const uint64\+\_\+t}]{ipoly,  }\item[{const int}]{ibead,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{dx,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{dy,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{dz,  }\item[{\mbox{\hyperlink{soma__config_8h_a59e3fe53d267a97ff32b8a16fea1f683}{soma\+\_\+scalar\+\_\+t}} $\ast$}]{smc\+\_\+deltaE,  }\item[{const \mbox{\hyperlink{structMonomer}{Monomer}} $\ast$}]{mybead,  }\item[{\mbox{\hyperlink{structRNG__STATE}{RNG\+\_\+\+STATE}} $\ast$const}]{myrngstate,  }\item[{const unsigned int}]{iwtype }\end{DoxyParamCaption})}



Smart Monte-\/\+Carlo (SMC) move. Calculate the displacement and the energy change from the forces. 


\begin{DoxyParams}{Parameters}
{\em p} & Initialized configuration. \\
\hline
{\em ipoly} & \mbox{\hyperlink{structPolymer}{Polymer}} of moving bead \\
\hline
{\em ibead} & \mbox{\hyperlink{structMonomer}{Monomer}} of moving bead \\
\hline
{\em dx} & proposed displacement calculated from the forces in x \\
\hline
{\em dy} & proposed displacement calculated from the forces in y \\
\hline
{\em dz} & proposed displacement calculated from the forces in z \\
\hline
{\em smc\+\_\+deltaE} & energy change calculated from the forces acting on the bead before and after the proposed move. \\
\hline
{\em mybead} & Selected bead for the MC move \\
\hline
{\em myrngstate} & State of the random number generator, used to generate the random vector. \\
\hline
{\em iwtype} & Type of the monomer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
displacement of the proposed move (in dx,dy,dz components) and energy change of the proposed SMC move.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
only bonded forces are considered. Calculation of other forces (e.\+g. external fields) can be added in this function. 
\end{DoxyNote}
